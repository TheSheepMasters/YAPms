class Account{static register(){const formData=new FormData,email=document.getElementById("email-input").value;formData.append("email",email),fetch("./api/users/register.php",{method:"POST",body:formData,credentials:"include"}).then(response=>response.text()).then(data=>{console.log("Register: "+data);data=data.split(" ");document.getElementById("register-info");closeAllPopups(),"good"===data[0]?displayNotification("Account Registered","Please check your email, and click the verification link. (check your spam)"):"inuse"===data[1]?displayNotification("Register Error","Account Already Registered"):"inactive"===data[1]?displayNotification("Register Error","Verification Email Already Sent (check your spam)"):"resent"===data[1]?displayNotification("Account Registered","Please check your email, and click the verification link. (check your spam)"):"invalid_email"===data[1]&&displayNotification("Register Error",email+" is not a valid email")}).catch(error=>{console.log(error);const registerInfo=document.getElementById("register-info");registerInfo.innerHTML="Connection Error"})}static login(){const formData=new FormData;var email=document.getElementById("email-login").value,pass=document.getElementById("password-login").value;formData.append("email",email),formData.append("password",pass),fetch("./api/users/login.php",{method:"POST",body:formData,credentials:"include"}).then(response=>response.text()).then(data=>{console.log("Login: "+data);var data=data.split(" "),loginInfo=(Account.verifyState(),document.getElementById("password-login").value="",document.getElementById("login-info"));"good"===data[0]?(loginInfo.innerHTML="Please enter your credentials",closeAllPopups()):"bad"===data[0]&&("account_innactive"===data[1]?loginInfo.innerHTML="Inactive Account":"incorrect_login"===data[1]&&(loginInfo.innerHTML="Incorrect Login"))}).catch(error=>{console.log(error);const loginInfo=document.getElementById("login-info");loginInfo.innerHTML="Connection Error"})}static verifyState(){const formData=new FormData;formData.append("email",Account.email),fetch("./api/users/verify_login.php",{method:"POST",body:formData,credentials:"include"}).then(response=>response.text()).then(data=>{console.log("Verify Login: "+data);data=data.split(" ");Account.isLoggedIn="good"===data[0],Account.isLoggedIn?(Account.email=data[1],Account.id=data[2]):(Account.id=null,Account.email=null),Account.updateHTML()}).catch(error=>{console.log(error),console.log("Account: Could not login")})}static logout(){closeAllPopups(),fetch("./api/users/logout.php",{method:"POST",credentials:"include"}).then(response=>response.text()).then(data=>{console.log("Logout: "+data),Account.verifyState()}).catch(error=>{console.log(error)})}static unlink(mapName){var formData=new FormData;formData.append("mapName",mapName),fetch("./api/users_maps/unlink.php",{method:"POST",body:formData,credentials:"include"}).then(response=>response.text()).then(data=>{gtag("event",currentCache,{event_category:"Account",event_label:"Map Deleted From Account"})}).catch(error=>{console.log(error)})}static save(mapName){var candidate,formData=new FormData,img=document.getElementById("mysaves-current-mappreview"),error=(img&&formData.append("img",img.src),mapName?formData.append("mapName",mapName):(img=document.getElementById("mysaves-name-input"))&&(formData.append("mapName",img.value),img.value=""),document.getElementById("mysaves-current-error")),data=(error&&(error.style.display="none"),{});for(key in data.filename=MapLoader.save_filename,data.dataid=MapLoader.save_dataid,data.type=MapLoader.save_type,data.year=MapLoader.save_year,data.fontsize=MapLoader.save_fontsize,data.strokewidth=MapLoader.save_strokewidth,data.candidates={},data.states={},data.proportional={},CandidateManager.candidates)"Tossup"!==key&&(candidate=CandidateManager.candidates[key],data.candidates[candidate.name]={},data.candidates[candidate.name]=candidate.colors);for(var stateIndex=0;stateIndex<states.length;++stateIndex){for(key in(state=states[stateIndex]).delegates)0===state.delegates[key]&&delete state.delegates[key];data.states[state.name]={},data.states[state.name].delegates=state.delegates,data.states[state.name].simulator=state.simulator,data.states[state.name].colorvalue=state.colorValue,data.states[state.name].disabled=state.disabled}for(var state,key,stateIndex=0;stateIndex<proportionalStates.length;++stateIndex){for(key in(state=proportionalStates[stateIndex]).delegates)0===state.delegates[key]&&delete state.delegates[key];data.proportional[state.name]={},data.proportional[state.name].delegates=state.delegates,data.proportional[state.name].simulator=state.simulator,data.proportional[state.name].colorvalue=state.colorValue,data.proportional[state.name].disabled=state.disabled}formData.append("data",JSON.stringify(data)),fetch("./api/users_maps/upload.php",{method:"POST",body:formData,credentials:"include"}).then(response=>response.text()).then(data=>{var data=data.split(" ");"bad"===data[0]?(error.style.display="inline","no_map_name"===data[1]?error.innerHTML="Enter Map Name":"file_limit"===data[1]?error.innerHTML="File Limit Reached":error.innerHTML="Upload Error"):(data=data[1],Account.addMapBox(data,!0),gtag("event",currentCache,{event_category:"Account",event_label:"Map Saved To Account"}))}).catch(error=>{console.log(error)})}static changePassword(){const formData=new FormData;var current=document.getElementById("password-reset-1").value,newPass=document.getElementById("password-reset-2").value,verifyPass=document.getElementById("password-reset-3").value;formData.append("current",current),formData.append("new",newPass),formData.append("verify",verifyPass),fetch("./api/users/change_password.php",{method:"POST",body:formData,credentials:"include"}).then(response=>response.text()).then(data=>{console.log("Change Password: "+data);data=data.split(" ");const passwordChangeInfo=document.getElementById("passwordchange-info");if("good"===data[0])closeAllPopups(),displayNotification("Password Change","Your password has been changed"),passwordChangeInfo.innerHTML="Please enter current and new password",document.getElementById("password-reset-1").value="",document.getElementById("password-reset-2").value="",document.getElementById("password-reset-3").value="";else if("bad"===data[0])switch(data[1]){case"verify_incorrect":passwordChangeInfo.innerHTML="Passwords do not match";break;case"incorrect_pass":passwordChangeInfo.innerHTML="Current password incorrect";break;case"no_post":passwordChangeInfo.innerHTML="Missing information"}}).catch(error=>{console.log(error)})}static forgotPassword(){const formData=new FormData,email=document.getElementById("email-forgot-input").value;formData.append("email",email),fetch("./api/users/forgot_password.php",{method:"POST",body:formData,credentials:"include"}).then(response=>response.text()).then(data=>{console.log("Forgot Password: "+data);data=data.split(" ");if(closeAllPopups(),"good"===data[0])"reset_sent"===data[1]&&displayNotification("Password Reset","Password reset email sent. (check your spam)");else if("bad"===data[0])switch(data[1]){case"innactive_account":displayNotification("Password Reset Error",email+" is not active. Please register or verify.");break;case"recent_verification":displayNotification("Password Reset Error","Password was recently reset, please wait.");break;case"please_register":displayNotification("Password Reset Error",email+" is not registered. Please register.")}}).catch(error=>{console.log(error)})}static addMapBox(base64name,preappend){var mapBoxHeader,name_onclick,thisMap,allMaps,ref_mapName,mapDownloadImg,url,mapToolbar,mapDelete,name=base64name,base64name=atob(base64name),previous=document.getElementById("mappreview-"+name);previous?previous.src="https://yapms.org/users/"+Account.id+"/"+name+".png#"+(new Date).getTime():((previous=document.createElement("div")).className="mysaves-mapbox",previous.id="mapbox-"+name,(mapBoxHeader=document.createElement("div")).className="mysaves-mapbox-header",(mapToolbar=document.createElement("div")).className="mysaves-mapbox-toolbar",(mapDelete=document.createElement("img")).className="toolbar-button toolbar-button-red",mapDelete.src="./html/deletebutton.svg",mapDelete.setAttribute("title","Delete Map"),mapDelete.onclick=(name_onclick=name,thisMap=previous,allMaps=document.getElementById("mysaves-maps"),function(){Account.unlink(name_onclick),allMaps&&thisMap&&allMaps.removeChild(thisMap)}),mapToolbar.appendChild(mapDelete),(mapDelete=document.createElement("a")).setAttribute("class","toolbar-button toolbar-button-blue"),mapDelete.setAttribute("href","./api/users_maps/download.php?u="+Account.id+"&m="+name),mapDelete.setAttribute("title","Download"),(mapDownloadImg=document.createElement("img")).src="./html/downloadbutton.svg",mapDownloadImg.setAttribute("class","toolbar-button-download"),mapDelete.appendChild(mapDownloadImg),mapToolbar.appendChild(mapDelete),(mapDownloadImg=document.createElement("img")).setAttribute("class","toolbar-button toolbar-button-green"),mapDownloadImg.src="./html/overwritebutton.svg",mapDownloadImg.setAttribute("title","Overwrite"),mapDownloadImg.onclick=(ref_mapName=base64name,function(){Account.save(ref_mapName)}),mapToolbar.appendChild(mapDownloadImg),mapBoxHeader.appendChild(mapToolbar),(mapDelete=document.createElement("div")).className="mysaves-mapname",mapDelete.innerHTML=base64name,mapBoxHeader.appendChild(mapDelete),previous.appendChild(mapBoxHeader),(mapDownloadImg=document.createElement("img")).className="mysaves-mappreview",mapDownloadImg.id="mappreview-"+name,mapDownloadImg.src="https://"+window.location.hostname+"/app/www-data/users/"+Account.id+"/"+name+".png#"+(new Date).getTime(),mapDownloadImg.alt="No Preview",mapDownloadImg.onclick=(url="./?u="+Account.id+"&m="+name,function(){window.location.href=url}),previous.appendChild(mapDownloadImg),(mapToolbar=document.createElement("div")).className="mysaves-url",base64name=document.createTextNode("https://"+window.location.hostname+"/app/?u="+Account.id+"&m="+name),mapToolbar.appendChild(base64name),previous.appendChild(mapToolbar),mapDelete=document.getElementById("mysaves-maps"),preappend?mapDelete.insertBefore(previous,mapDelete.firstChild):mapDelete.appendChild(previous))}static closeMyMaps(){document.getElementById("application-mysaves").style.display="none";for(var maps=document.getElementById("mysaves-maps");maps.firstChild;)maps.removeChild(maps.firstChild)}static getMaps(){for(var maps=document.getElementById("mysaves-maps");maps.firstChild;)maps.removeChild(maps.firstChild);var current=document.getElementById("mysaves-current-map"),current=(current&&(current.style.display="none"),document.getElementById("mysaves-current-error")),current=(current&&(current.style.display="none"),document.getElementById("application-mysaves")),current=(current&&(current.style.display="inline-flex"),document.getElementById("application"));domtoimage.toPng(current,{width:current.offsetWidth,height:current.offsetHeight}).then(function(data){const image=document.getElementById("mysaves-current-mappreview"),current=(image.src=data,image.style.width="40vw",image.style.height="auto",document.getElementById("mysaves-current-map"));current.style.display="inline-flex"}).catch(function(error){console.log("dom-to-image: ",error)}),fetch("https://"+window.location.hostname+"/app/api/users_maps/get_maps.php",{method:"POST",credentials:"include"}).then(response=>response.text()).then(data=>{data=data.split(" ");for(let fileIndex=0;fileIndex<data.length;++fileIndex){const fileName=data[fileIndex].split("/");console.log(fileName);var name=fileName[5].split(".")[0];Account.addMapBox(name,!1)}}).catch(error=>{console.log(error)})}static updateHTML(){const loginButton=document.getElementById("login-button"),accountButton=document.getElementById("account-button"),mymapsButton=document.getElementById("mymaps-button"),accountEmail=document.getElementById("account-email");Account.isLoggedIn?(loginButton.style.display="none",accountButton.style.display="",mymapsButton.style.display="",accountEmail.innerHTML=Account.email):(loginButton.style.display="",accountButton.style.display="none",mymapsButton.style.display="none")}}Account.email=null,Account.id=null,Account.isLoggedIn=!1,document.getElementById("login-form").onsubmit=function(e){e.preventDefault(),Account.login()};class Candidate{constructor(name,colors){this.name=name,this.colors=colors,this.voteCount=0,this.probVoteCounts=[0,0,0,0],colors[0]===colors[1]&&colors[0]===colors[2]&&colors[0]===colors[3]?this.singleColor=!0:this.singleColor=!1}}class CandidateManager{static initCandidates(){CandidateManager.candidates=[],CandidateManager.candidates.Tossup=CandidateManager.TOSSUP}static deleteCandidate(){closeAllPopups();for(var candidateid=document.getElementById("candidate-originalName").value,index=0;index<states.length;++index){var state=states[index];state.candidate===candidateid&&state.setColor("Tossup",0),state.delegates[candidateid]=void 0}delete CandidateManager.candidates[candidateid],LegendManager.generateLegend(),countVotes(),LegendManager.updateLegend(),ChartManager.updateChart()}static setCandidate(){closeAllPopups();var oldname=document.getElementById("candidate-originalName").value,newname=document.getElementById("candidate-name").value;const candidate=CandidateManager.candidates[oldname],newColors=[];for(const child of document.getElementById("editcandidate-colors").children)newColors.push(child.value);newname!==oldname&&(Object.defineProperty(CandidateManager.candidates,newname,Object.getOwnPropertyDescriptor(CandidateManager.candidates,oldname)),delete CandidateManager.candidates[oldname]),candidate.name=newname,candidate.colors=newColors;for(let index=0;index<states.length;++index){const state=states[index];state.candidate===newname?state.setColor(newname,state.colorValue,{setDelegates:!1}):state.candidate===oldname&&(state.setColor(newname,state.colorValue,{setDelegates:!1}),state.delegates[newname]=state.delegates[oldname],state.delegates[oldname]=void 0),state.colorValue>=candidate.colors.length&&(state.candidate===newname||state.candidate===oldname)&&state.setColor(newname,0,{setDelegates:!1})}countVotes(),LegendManager.generateLegend(),LegendManager.updateLegend(),ChartManager.updateChart()}static addCandidate3(){var name=document.getElementById("name").value;const colors=[];for(const colorDom of document.getElementById("addcandidate-colors").children)colors.push(colorDom.value);var candidate=new Candidate(name,colors);CandidateManager.candidates[name]=candidate,verifyPaintIndex(),LegendManager.generateLegend(),ChartManager.updateChart(),LegendManager.updateLegend()}static addCandidate2(name,colors){var nameHTML;""!==(name=void 0===name?null!==(nameHTML=document.getElementById("name"))?nameHTML.value:"Error":name).trim()&&(nameHTML=new Candidate(name,colors),CandidateManager.candidates[name]=nameHTML,verifyPaintIndex(),LegendManager.generateLegend(),ChartManager.updateChart(),LegendManager.updateLegend())}static addCandidate(name,solid,likely,leaning,tilting){var nameHTML;""!==(name=void 0===name?null!==(nameHTML=document.getElementById("name"))?nameHTML.value:"Error":name).trim()&&(void 0===solid&&(solid=null!==(nameHTML=document.getElementById("solid"))?nameHTML.value:"#000000"),void 0===likely&&(likely=null!==(nameHTML=document.getElementById("likely"))?nameHTML.value:"#000000"),void 0===leaning&&(leaning=null!==(nameHTML=document.getElementById("leaning"))?nameHTML.value:"#000000"),void 0===tilting&&(tilting=null!==(nameHTML=document.getElementById("tilting"))?nameHTML.value:"#000000"),nameHTML=new Candidate(name,[solid,likely,leaning,tilting]),CandidateManager.candidates[name]=nameHTML,verifyPaintIndex(),LegendManager.generateLegend(),ChartManager.updateChart(),LegendManager.updateLegend())}static saveCustomColors(){var name=document.getElementById("custom-color-name").value,element=document.getElementById("customcolor-colors");for(let index=0;index<element.children.length;index+=1){var child=element.children[index];CookieManager.appendCookie(name+"-"+index,child.value)}}static setColors(palette){document.getElementById("solid"),document.getElementById("likely"),document.getElementById("leaning"),document.getElementById("tilting");let colors=null;switch(palette){case"red":colors=["#bf1d29","#ff5865","#ff8b98","#cf8980"];break;case"blue":colors=["#1c408c","#577ccc","#8aafff","#949bb3"];break;case"green":colors=["#1c8c28","#50c85e","#8aff97","#7a997e"];break;case"yellow":colors=["#e6b700","#e8c84d","#ffe78a","#b8a252"];break;case"blue-light":colors=["#5555ff","#8080ff","#aaaaff","#d5d5ff"];break;case"red-light":colors=["#ff5555","#ff8080","#ffaaaa","#ffd5d5"];break;case"blue-dark":colors=["#302e80","#444cc5","#817ffb","#cdd3f7"];break;case"red-dark":colors=["#80302e","#cb4b40","#fb817f","#f5c8c4"];break;case"purple":colors=["#822194","#ae20c6","#db14ff","#a369ae"];break;case"blue1-interpolation":colors=["#0d0596","#2b26a5","#4948b4","#6769c3","#858ad2","#a3abe1","#c1cdf0","#dfeeff"];break;case"blue2-interpolation":colors=["#002b84","#234a99","#466aad","#6a89c2","#8da8d6","#b0c8eb","#d3e7ff"];break;case"red1-interpolation":colors=["#a80000","#b42021","#c14043","#cd6064","#da8086","#e6a0a7","#f3c0c9","#ffe0ea"];break;case"red2-interpolation":colors=["#800000","#952223","#aa4445","#c06668","#d5888b","#eaaaad","#ffccd0"];break;case"democratic1-wiki":colors=["#0d0596","#3933e5","#584cde","#6674de","#7996e2","#a5b0ff","#bdd3ff","#dfeeff"];break;case"democratic2-wiki":colors=["#002b84","#0645b4","#1666cb","#4389e3","#86b6f2","#b9d7ff","#d3e7ff"];break;case"republican1-wiki":colors=["#a80000","#c21b18","#d72f30","#d75d5d","#e27f7f","#ffb2b2","#ffc8cd","#ffe0ea"];break;case"republican2-wiki":colors=["#800000","#aa0000","#d40000","#cc2f4a","#e27f90","#f2b3be","#ffccd0"];break;case"dixiecrat-wiki":colors=["#aa4400","#d45500","#ff6600","#ff7f2a","#ff9955","#ffb380","#ffccaa"];break;case"unpledged-wiki":colors=["#be9600","#daae00","#f4c200","#ffdc43","#ffe680","#ffeeaa"];break;default:colors=[];let number=0;for(;CookieManager.cookies[palette+"-"+number];)colors.push(CookieManager.cookies[palette+"-"+number]),number+=1}const colorsDom=document.getElementById("addcandidate-colors");for(;colorsDom.firstChild;)colorsDom.removeChild(colorsDom.firstChild);for(const color of colors){const colorDom=document.createElement("input");colorDom.classList.add("addcandidate-color"),colorDom.value=color,colorDom.type="color",colorsDom.appendChild(colorDom)}}}CandidateManager.candidates=[],CandidateManager.tossupColor=2,CandidateManager.TOSSUP=new Candidate("Tossup",["#000000","#ffffff","#696969","#000000"]);class ChartManager{static initChart(){Chart.register(ChartDataLabels),Chart.defaults.font.color="#ffffff",ChartManager.chartOptions={indexAxis:"y",plugins:{datalabels:{display:function(context){return 0!==context.dataset.data[context.dataIndex]},backgroundColor:"white",borderColor:"black",color:"black",font:{family:"Roboto",size:15,weight:600}},legend:{display:!1},tooltip:{enabled:!1}}},ChartManager.chartBarScales={x:{stacked:!0,grid:{display:!1,drawBorder:!1},ticks:{color:"#fff",font:{family:"Roboto",size:13}}},y:{stacked:!0,grid:{display:!1,drawBorder:!1},ticks:{color:"#fff",font:{family:"Roboto",size:13}}}},ChartManager.chartPieScales={grid:{display:!1}},ChartManager.chartOptions.scales=ChartManager.chartPieScales;const ctx=document.getElementById("chart-canvas").getContext("2d");ctx.height=200,ChartManager.chart=new Chart(ctx,{type:"doughnut",data:{labels:[],datasets:[{label:"",backgroundColor:"#ffffff",borderColor:"#ffffff",borderWidth:0,data:[]},{label:"",backgroundColor:"#ffffff",borderColor:"#ffffff",borderWidth:0,data:[]},{},{}]},options:ChartManager.chartOptions,maintainAspectRatio:!0}),ChartManager.chartType="doughnut"}static setChart(type,position){console.log("Chart Manager: "+type);var charthtml,logo,sidebar=document.getElementById("chart-div"),chartHTML=document.getElementById("chart"),html=document.getElementById("chart-canvas"),ctx=html.getContext("2d"),battlechart=document.getElementById("battlechart");if(chartHTML.style.display="inline-block",battlechart.style.display="none",sidebar.style.display="flex",sidebar.style.width="28vw","none"===type)html.style.display="none",unsetBattleHorizontal(),sidebar.style.display="none",ChartManager.chartType=type,MapManager.centerMap();else if("horizontalbattle"===type||"verticalbattle"===type)if(3<Object.keys(CandidateManager.candidates).length)displayNotification("Sorry","This chart requires that there be two candidates");else{if("horizontalbattle"===type){setBattleHorizontal();let logo=document.getElementById("logo-div");logo.style.width="15%",logo.style.height="100%",sidebar.style.borderRight="0px",sidebar.style.borderTop="1px solid black",(logo=document.getElementById("yapms-watermark")).style.width="15%",logo.style.height="100%"}else if("verticalbattle"===type){unsetBattleHorizontal(),sidebar.style.width="20vw";let logo=document.getElementById("logo-div");logo.style.width="100%",logo.style.height="15%",sidebar.style.borderTop="0px",sidebar.style.borderRight="1px solid black",(logo=document.getElementById("yapms-watermark")).style.width="100%",logo.style.height="15%"}html.style.display="none",chartHTML.style.display="none",battlechart.style.display="flex",ChartManager.chartType=type,ChartManager.updateChart(),MapManager.centerMap()}else{if(unsetBattleHorizontal(),"bottom"===(ChartManager.chartPosition=position)?(document.getElementById("application").style.flexDirection="column-reverse",document.getElementById("map-div").style.height="80%",sidebar.style.flexDirection="row",sidebar.style.width="100%",sidebar.style.height="20%",sidebar.style.borderRight="0px",sidebar.style.borderTop="1px solid black",(charthtml=document.getElementById("chart")).style.height="auto",charthtml.style.width=sidebar.offsetHeight-5+"px",(logo=document.getElementById("logo-div")).style.width="15%",logo.style.height="100%",(logo=document.getElementById("yapms-watermark")).style.width="15%",logo.style.height="100%"):(document.getElementById("application").style.flexDirection="row",document.getElementById("map-div").style.height="100%",sidebar.style.flexDirection="column",sidebar.style.width="28vw",sidebar.style.height="100%",sidebar.style.borderTop="0px",sidebar.style.borderRight="1px solid black",(charthtml=document.getElementById("chart")).style.width="100%",(logo=document.getElementById("logo-div")).style.width="100%",logo.style.height="15%",(logo=document.getElementById("yapms-watermark")).style.width="100%",logo.style.height="15%"),MapManager.centerMap(),ChartManager.chartType=type,ChartManager.chartData={labels:[],datasets:[{borderColor:ChartManager.chartBorderColor,borderWidth:ChartManager.chartBorderWidth,data:[]}]},html.style.display="inline-block","horizontalBar"===type){ChartManager.chartOptions.scales=ChartManager.chartBarScales,delete ChartManager.chartOptions.scale;for(let i=0;i<3;++i)ChartManager.chartData.datasets.push({borderColor:ChartManager.chartBorderColor,borderWidth:ChartManager.chartBorderWidth,data:[]})}else"pie"!==type&&"doughnut"!==type||(ChartManager.chartOptions.scales=ChartManager.chartPieScales,delete ChartManager.chartOptions.scale);ChartManager.chart.destroy(),ChartManager.chart=new Chart(ctx,{type:"horizontalBar"===type?"bar":type,data:ChartManager.chartData,options:ChartManager.chartOptions}),ChartManager.updateChart()}}static rebuildChart(){const canvas=document.getElementById("chart-canvas");var ctx=canvas.getContext("2d");if(ChartManager.chart.destroy(),ChartManager.chart=new Chart(ctx,{type:ChartManager.chart.config.type,data:ChartManager.chartData,options:ChartManager.chartOptions}),"battle"===ChartManager.chartType){const chartcontainer=document.getElementById("chart");chartcontainer.style.display="none"}ChartManager.updateChart()}static updateChart(){"verticalbattle"===ChartManager.chartType||"horizontalbattle"===ChartManager.chartType?ChartManager.updateBattleChart():("horizontalBar"===ChartManager.chartType?ChartManager.updateBarChart():ChartManager.updateNonRadarChart(),ChartManager.chart.config.data=ChartManager.chartData,ChartManager.chart.update())}static updateBarChart(){for(var key in ChartManager.chartData.labels=[],ChartManager.chartData.datasets=[],CandidateManager.candidates)ChartManager.chartData.labels.push(key);if(ChartManager.chartLeans){let maxColorCount=0;for(const key in CandidateManager.candidates){var candidate=CandidateManager.candidates[key];candidate.colors.length>maxColorCount&&(maxColorCount=candidate.colors.length)}for(const key in CandidateManager.candidates){const candidate=CandidateManager.candidates[key];for(let probIndex=0;probIndex<maxColorCount;++probIndex){void 0===ChartManager.chartData.datasets[probIndex]&&(ChartManager.chartData.datasets.push({}),ChartManager.chartData.datasets[probIndex].data=[],ChartManager.chartData.datasets[probIndex].backgroundColor=[]);var count=candidate.probVoteCounts[probIndex],count=(ChartManager.chartData.datasets[probIndex].data.push(count),candidate.colors[probIndex]);ChartManager.chartData.datasets[probIndex].backgroundColor.push(count)}}}else for(const key in CandidateManager.candidates){const candidate=CandidateManager.candidates[key],count=candidate.voteCount;if(void 0===ChartManager.chartData.datasets[0]&&(ChartManager.chartData.datasets[0]={},ChartManager.chartData.datasets[0].data=[],ChartManager.chartData.datasets[0].backgroundColor=[]),ChartManager.chartData.datasets[0].data.push(count),"Tossup"===key){const color=candidate.colors[2];ChartManager.chartData.datasets[0].backgroundColor.push(color)}else{const color=candidate.colors[0];ChartManager.chartData.datasets[0].backgroundColor.push(color)}}}static updateNonRadarChart(){ChartManager.chartData.labels=[],ChartManager.chartData.datasets[0].data=[],ChartManager.chartData.datasets[0].backgroundColor=[],ChartManager.chartData.datasets[0].borderColor=ChartManager.chartBorderColor,ChartManager.chartData.datasets[0].borderWidth=ChartManager.chartBorderWidth;let candidateIndex=-1;for(const key in CandidateManager.candidates){++candidateIndex;var candidate=CandidateManager.candidates[key],name=candidate.name,voteCount=candidate.voteCount;let color=candidate.colors[0];if(0==candidateIndex)color=CandidateManager.candidates.Tossup.colors[CandidateManager.tossupColor],ChartManager.chartData.labels[0]="Tossup",ChartManager.chartData.datasets[0].data.push(voteCount),ChartManager.chartData.datasets[0].backgroundColor.push(color);else if(ChartManager.chartLeans)for(let probIndex=0;probIndex<candidate.colors.length;++probIndex){var count=candidate.probVoteCounts[probIndex],index=(color=candidate.colors[probIndex],probIndex+8*candidateIndex-7);ChartManager.chartData.labels[index]=name,ChartManager.chartData.datasets[0].data.push(count),ChartManager.chartData.datasets[0].backgroundColor.push(color)}else{const count=candidate.voteCount;color=candidate.colors[0],ChartManager.chartData.labels[candidateIndex]=name,ChartManager.chartData.datasets[0].data.push(count),ChartManager.chartData.datasets[0].backgroundColor.push(color)}}}static updateBattleChart(){if(3<Object.keys(CandidateManager.candidates).length)mobile?ChartManager.setChart("pie","bottom"):ChartManager.setChart("pie");else{let candidateIndex=-1;for(const candidateKey in CandidateManager.candidates){candidateIndex+=1;const candidate=CandidateManager.candidates[candidateKey];if("Tossup"===candidateKey){const tossup=document.getElementById("bar-0");tossup.style.background=candidate.colors[2],tossup.style.flexBasis=candidate.voteCount/totalVotes*100+"%",ChartManager.chartLabels?tossup.innerHTML="<p>"+candidate.voteCount+"</p>":tossup.innerHTML="<p></p>"}else{const bar=document.getElementById("bar-"+candidateIndex),toRemove=(bar.style.flexBasis=candidate.voteCount/totalVotes*100+"%",[]);for(const part of bar.children)parseInt(part.id.split("-")[1])>=candidate.colors.length&&toRemove.push(part);for(const part of toRemove)bar.removeChild(part);if(ChartManager.chartLeans)for(const index in candidate.colors){let part=document.getElementById(candidateIndex+"-"+index);if(null===part)switch((part=document.createElement("div")).classList.add("bar-part"),part.id=candidateIndex+"-"+index,candidateIndex){case 1:bar.appendChild(part);break;case 2:bar.insertBefore(part,bar.firstChild)}part.style.flexBasis=(candidate.probVoteCounts[index]||0)/candidate.voteCount*100+"%",part.style.background=candidate.colors[index],ChartManager.chartLabels?part.innerHTML="<p>"+(candidate.probVoteCounts[index]||0)+"</p>":part.innerHTML="<p></p>"}else for(const index in candidate.colors){const part=document.getElementById(candidateIndex+"-"+index);part&&("0"===index?(part.style.flexBasis="100%",part.style.background=candidate.colors[0],ChartManager.chartLabels?part.innerHTML="<p>"+candidate.probVoteCounts.reduce((a,b)=>a+b,0)+"</p>":part.innerHTML="<p></p>"):(part.style.flexBasis="0%",part.style.background=candidate.colors[0],part.innerHTML="<p></p>"))}}}}}static toggleChartLabels(){ChartManager.chartLabels=!ChartManager.chartLabels,0!=ChartManager.chartOptions.plugins.datalabels.display?ChartManager.chartOptions.plugins.datalabels.display=!1:ChartManager.chartOptions.plugins.datalabels.display=function(context){return 0!==context.dataset.data[context.dataIndex]},ChartManager.rebuildChart()}static toggleChartLeans(){ChartManager.chartLeans=!ChartManager.chartLeans,ChartManager.rebuildChart(),ChartManager.updateBattleChart()}}ChartManager.chart=null,ChartManager.chartBorderWidth=2,ChartManager.chartBorderColor="#000000",ChartManager.chartData={labels:[],datasets:[{label:"",backgroundColor:[],borderColor:ChartManager.chartBorderColor,borderWidth:ChartManager.chartBorderWidth,data:[]},{},{},{}]},ChartManager.chartOptions=null,ChartManager.chartType=null,ChartManager.chartPosition=null,ChartManager.chartPieScales=null,ChartManager.chartBarScales=null,ChartManager.chartLeans=!0,ChartManager.chartLabels=!0;class CookieManager{static appendCookie(key,value){var expire,cookie;!1===CookieManager.consent?console.log("Cookie Manager: no consent"):(CookieManager.cookies[key]=value,cookie="",expire=new Date(Date.now()+3024e7).toString(),cookie=key+"="+CookieManager.cookies[key]+"; expires="+expire+";",document.cookie=cookie,console.log("Append cookie: key="+key+" value="+value))}static loadCookies(){CookieManager.cookies.theme="default";const decode=decodeURIComponent(document.cookie),loadedCookies=decode.split("; ");for(var index in loadedCookies){var index=loadedCookies[index].split("="),key=index[0],index=index[1];CookieManager.cookies[key]=index}}static loadCustomColors(){for(let buttonIndex=1;buttonIndex<=10;buttonIndex+=1){let button=document.getElementById("custom"+buttonIndex+"button");if(CookieManager.cookies["custom"+buttonIndex+"-0"]){let style="linear-gradient(to right,",colorIndex=0;for(;CookieManager.cookies["custom"+buttonIndex+"-"+colorIndex];)style+=" "+CookieManager.cookies["custom"+buttonIndex+"-"+colorIndex]+",",colorIndex+=1;style=style.slice(0,-1),style+=")",button.style.background="green",button.style.background=style}else button.style.background="#000000"}}static askConsent(){"false"===CookieManager.cookies.consent?(CookieManager.consent=!1,CookieManager.consentDenied()):(CookieManager.cookies.consent,CookieManager.consent=!0,CookieManager.consentGiven())}static consentDenied(reload){document.getElementById("consent").style.display="none",CookieManager.consent=!0,CookieManager.appendCookie("consent",!1),CookieManager.consent=!1,reload&&location.reload()}static consentGiven(){document.getElementById("consent").style.display="none",CookieManager.consent=!0,CookieManager.appendCookie("consent",!0)}}CookieManager.cookies={},CookieManager.consent=!1;class KeyboardManager{static quickFill(){return!0===KeyboardManager.keyStates[70]}static areaSelect(){return!0===KeyboardManager.keyStates[68]}static ctrlPressed(){return!0===KeyboardManager.keyStates[17]}}KeyboardManager.keyStates={},document.addEventListener("keydown",function(event){KeyboardManager.keyStates[event.which]=!0}),document.addEventListener("keyup",function(event){KeyboardManager.keyStates[event.which]=!1}),document.addEventListener("mouseleave",function(event){KeyboardManager.keyStates={}}),document.addEventListener("mouseenter",function(event){KeyboardManager.keyStates={}});class LegendManager{static toggleLegendCounter(){LegendManager.legendCounter=!LegendManager.legendCounter,LegendManager.updateLegend()}static toggleLegendLeans(){LegendManager.legendLeans=!LegendManager.legendLeans,LegendManager.generateLegend(),LegendManager.updateLegend()}static selectCandidateDisplay(html){for(const button of html.parentElement.children){const text=button.childNodes[0];text.style.padding="4px"}html.childNodes[0].style.padding="7px"}static updateLegend(){for(var key in CandidateManager.candidates){var candidate=CandidateManager.candidates[key],html=document.getElementById(candidate.name+"-text"),newHTML=candidate.name;1==LegendManager.legendCounter&&(newHTML+=" "+candidate.voteCount),null!==html&&(html.innerHTML=newHTML,key===paintIndex&&LegendManager.selectCandidateDisplay(html.parentElement))}}static generateLegend(){console.log("Generating Legend...");const legendDiv=document.getElementById("legend-div");legendDiv.innerHTML="";let index=-1;for(const key in CandidateManager.candidates){const candidate=CandidateManager.candidates[key],legendElement=(++index,document.createElement("div")),legendText=(legendElement.setAttribute("id",candidate.name),legendElement.setAttribute("class","legend-button"),legendElement.addEventListener("click",function(){const ref_key=key;return function(){legendClick(ref_key,this)}}()),legendElement.style.background="none",legendDiv.appendChild(legendElement),document.createElement("div"));var color;legendText.setAttribute("id",candidate.name+"-text"),legendText.setAttribute("class","legend-button-text"),legendText.style.backgroundColor=candidate.colors[0],0==index&&(color=candidate.colors[CandidateManager.tossupColor],legendText.style.backgroundColor=color),legendText.style.padding="0px",legendText.innerHTML=candidate.name,legendElement.appendChild(legendText);const legendDelete=document.createElement("div"),legendColorDiv=(legendDelete.setAttribute("class","legend-delete"),legendDelete.style.backgroundColor="black",legendText.appendChild(legendDelete),document.createElement("div"));if(legendColorDiv.setAttribute("class","legend-color-div"),legendElement.appendChild(legendColorDiv),candidate.singleColor&&(legendColorDiv.style.display="none"),"Tossup"!==key){const legendEdit=document.createElement("div"),legendEditText=(legendEdit.setAttribute("class","legend-delete"),legendEdit.addEventListener("click",function(){const ref_name=candidate.name;return function(){displayCandidateEditMenu(ref_name)}}()),legendEdit.style.background="none",php_candidate_edit&&legendDiv.appendChild(legendEdit),document.createElement("div")),legendEditIcon=(legendEditText.setAttribute("class","legend-delete-text"),legendEditText.style.backgroundColor=candidate.colors[0],legendEditText.style.padding="0px",legendEditText.style.fontSize="14px",document.createElement("i"));legendEditIcon.classList.add("fas","fa-cog"),legendEditText.appendChild(legendEditIcon),legendEdit.appendChild(legendEditText)}if("Tossup"!==key&&LegendManager.legendLeans)for(let index=0;index<candidate.colors.length;++index){const legendColor=document.createElement("div");legendColor.classList.add("legend-color"),legendColor.setAttribute("id",candidate.name+index),legendColor.style.backgroundColor=candidate.colors[index],legendColorDiv.appendChild(legendColor)}}const legendElement=document.createElement("div");legendElement.id="legend-addcandidate-button",legendElement.classList.add("legend-button"),legendElement.addEventListener("click",displayAddCandidateMenu),legendElement.style.background="none",php_candidate_edit&&legendDiv.appendChild(legendElement);var legendText=document.createElement("div"),legendColorDiv=(legendText.setAttribute("id","addcandidate-button-text"),legendText.setAttribute("class","legend-button-text"),legendText.style.backgroundColor=CandidateManager.candidates.Tossup.colors[CandidateManager.tossupColor],legendText.style.padding="0px",legendText.innerHTML="+",legendElement.appendChild(legendText),document.createElement("div")),legendColorDiv=(legendColorDiv.setAttribute("class","legend-color-div"),legendElement.appendChild(legendColorDiv),document.createElement("div")),legendText=(legendColorDiv.setAttribute("id","legend-tooltip"),legendDiv.appendChild(legendColorDiv),document.createElement("div"));legendText.setAttribute("id","legendtooltip-text"),legendText.setAttribute("class","legend-button-text"),legendText.style.padding="0px",legendText.innerHTML="Select a candidate",legendColorDiv.appendChild(legendText)}}LegendManager.legendCounter=!0,LegendManager.legendLeans=!0;class LogoManager{static toggleLogo(name){var logoSlot=document.getElementById("logo-div");switch(name){case"LTE":logoSlot.style.backgroundImage='url("./res/logos/lte.png")';break;case"RedEagle":logoSlot.style.backgroundImage='url("./res/logos/redeagletv.png")';break;case"PG":logoSlot.style.backgroundImage='url("./res/logos/pg.png")';break;case"EP":logoSlot.style.backgroundImage='url("./res/logos/ep.png")';break;case"RedDonkey":logoSlot.style.backgroundImage='url("./res/logos/reddonkey.png")';break;case"PoliticalAnalyst":logoSlot.style.backgroundImage='url("./res/logos/pa.png")'}LogoManager.currentLogo!==name||""===logoSlot.style.display?logoSlot.style.display="inline":"inline"===logoSlot.style.display&&(logoSlot.style.display=""),LogoManager.currentLogo=name}static loadButtons(){if(!LogoManager.buttonsLoaded){LogoManager.buttonsLoaded=!0;for(var backButtons_addcandidatemenu=document.getElementsByClassName("backbutton-addcandidatemenu"),backButtons=document.getElementsByClassName("backbutton"),closeButtons=document.getElementsByClassName("closebutton"),index=0;index<backButtons_addcandidatemenu.length;++index)backButtons_addcandidatemenu[index].setAttribute("data","./html/backbutton-addcandidate.svg");for(index=0;index<backButtons.length;++index)backButtons[index].setAttribute("data","./html/backbutton.svg");for(index=0;index<closeButtons.length;++index)closeButtons[index].setAttribute("data","./html/closebutton.svg")}}static loadFlags(){if(!LogoManager.flagsLoaded){LogoManager.flagsLoaded=!0;for(var countries=["aus","usa","bra","can","ger","ind","ita","ire","ned","prt","rus","esp","tur","ukd","eu","un","fra","tat","che","zaf","swe","arg","pak"],countryIndex=0;countryIndex<countries.length;++countryIndex)for(var country=countries[countryIndex],elements=document.getElementsByClassName("flag-"+country),elementIndex=0;elementIndex<elements.length;++elementIndex)elements[elementIndex].setAttribute("src","res/flags/"+country+".svg")}}}LogoManager.currentLogo="",LogoManager.buttonsLoaded=!1,LogoManager.flagsLoaded=!1;class MapManager{static centerMap(){if(MapManager.panObject){MapManager.panObject.dispose();var mapdiv=document.getElementById("map-div");const svg=document.getElementById("svgdata");var bb=svg.getBBox();svg.setAttribute("viewBox","0 0 "+(bb.x+bb.width+bb.x)+" "+(bb.y+bb.height+bb.y)),MapManager.panObject=panzoom(svg,{transformOrigin:{x:.5,y:.5},autocenter:!0,zoomDoubleClickSpeed:1,smoothScroll:!1,initialX:mapdiv.offsetWidth/2,initialY:mapdiv.offsetHeight/2,initialZoom:.85,zoomSpeed:.05,onTouch:function(e){return!1}})}}static setLockMap(set){const lockButton=document.getElementById("lockbutton");!0===set?(lockButton&&(lockButton.style.opacity="0.5"),MapManager.panObject.pause(),MapManager.lockedMap=!0):(lockButton&&(lockButton.style.opacity="1"),MapManager.panObject.resume(),MapManager.lockedMap=!1)}static toggleLockMap(){const lockButton=document.getElementById("lockbutton");MapManager.lockedMap?(lockButton&&(lockButton.style.opacity="1"),MapManager.panObject.resume(),MapManager.lockedMap=!1):(lockButton&&(lockButton.style.opacity="0.5"),MapManager.panObject.pause(),MapManager.lockedMap=!0)}}MapManager.lockedMap=!1,MapManager.panObject=null;class MapLoader{static loadPresetMap(preset,options){CandidateManager.initCandidates(),fetch("./res/presets/"+preset).then(response=>response.json()).then(data=>{console.log(data),MapLoader.loadSavedMap(data)}).catch(error=>{console.error(error)})}static loadMapFromURL(URL){console.log("Map Loader: "+URL),fetch(URL).then(response=>response.json()).then(data=>{PresetLoader.loadPreset("none"),console.log("Map Loader: Found saved map"),MapLoader.loadSavedMap(data)}).catch(error=>{console.log("Map Loader: Did not find saved map"),console.log(error),PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/presidential/usa_presidential.svg",16,1,"usa_ec","presidential","open");const notification=document.getElementById("notification"),message=notification.querySelector("#notification-message"),title=notification.querySelector("#notification-title");title.innerHTML="Sorry",message.innerHTML="The map you are looking for does not exist.<br><br>This feature is still in development and it may have been deleted.",notification.style.display="inline"})}static loadMapFromId(id){switch(id){case"USA_current_house":PresetLoader.loadPreset("none"),MapLoader.loadPresetMap("usa/"+id);break;case"UnitedKingdom_current_parliament":PresetLoader.loadPreset("none"),MapLoader.loadPresetMap("ukd/"+id);break;case"USA_current_senate":case"USA_current_governors":case"USA_2024_projection":case"USA_2020_presidential":case"USA_2020_cook":case"USA_2020_inside":case"USA_2020_sabatos":case"USA_2020_house_cook":case"USA_2016_presidential":case"USA_2016_presidential_county":case"USA_2016_democratic_primary":case"USA_2016_republican_primary":case"USA_2012_presidential":case"USA_2008_presidential":case"USA_2004_presidential":case"USA_2000_presidential":case"USA_1996_presidential":case"USA_1992_presidential":case"USA_1988_presidential":case"USA_1984_presidential":case"USA_1980_presidential":case"USA_1976_presidential":case"USA_1972_presidential":case"USA_1968_presidential":case"USA_1964_presidential":case"USA_1960_presidential":case"USA_1956_presidential":case"USA_1952_presidential":case"USA_1948_presidential":case"USA_1944_presidential":case"USA_1940_presidential":case"USA_1936_presidential":case"USA_1932_presidential":case"USA_1928_presidential":case"USA_1924_presidential":case"USA_1920_presidential":case"USA_1916_presidential":case"USA_1912_presidential":case"USA_1908_presidential":case"USA_1904_presidential":case"USA_1900_presidential":case"USA_1896_presidential":case"USA_1892_presidential":case"USA_1888_presidential":case"USA_1884_presidential":case"USA_1880_presidential":case"USA_1876_presidential":case"USA_1872_presidential":case"USA_1868_presidential":case"USA_1864_presidential":case"USA_1789_presidential":case"USA_1792_presidential":case"USA_1796_presidential":case"USA_1800_presidential":case"USA_1804_presidential":case"USA_1808_presidential":case"USA_1812_presidential":case"USA_1816_presidential":case"USA_1820_presidential":case"USA_1824_presidential":case"USA_1828_presidential":case"USA_1832_presidential":case"USA_1836_presidential":case"USA_1840_presidential":case"USA_1844_presidential":case"USA_1848_presidential":case"USA_1852_presidential":case"USA_1856_presidential":case"USA_1860_presidential":case"USA_trump_impeachment_support":PresetLoader.loadPreset("none"),MapLoader.loadPresetMap("usa/"+id);break;case"Canada_2021_house_of_commons":case"Canada_2019_house_of_commons":PresetLoader.loadPreset("none"),MapLoader.loadPresetMap("can/"+id);break;case"Alabama_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/alabama/2020_house.svg",16,.15,"1","takeall_noedit","open");break;case"Alaska_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/alaska/2020_house.svg",16,.02,"1","takeall_noedit","open");break;case"Arizona_2020_state_upper":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/arizona/2020_upper.svg",16,.3,"1","takeall_noedit","open");break;case"Arizona_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/arizona/2020_lower.svg",16,.3,"2","proportional","open");break;case"Arkansas_2020_state_upper":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/arkansas/2020_upper.svg",16,4.5,"1","takeall_noedit","open");break;case"Arkansas_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/arkansas/2020_house.svg",16,150,"1","takeall_noedit","open");break;case"California_2020_state_upper":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/california/2020_upper.svg",16,.25,"1","takeall_noedit","open");break;case"California_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/california/2020_house.svg",16,.1,"1","takeall_noedit","open");break;case"Colorado_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/colorado/2020_house.svg",16,.15,"1","takeall_noedit","open");break;case"Connecticut_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/connecticut/2020_house.svg",16,.5,"1","takeall_noedit","open");break;case"Florida_2020_state_upper":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/florida/2020_upper.svg",16,.3,"1","takeall_noedit","open");break;case"Florida_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/florida/2020_house.svg",16,.25,"1","takeall_noedit","open");break;case"Hawaii_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/hawaii/2020_house.svg",16,.2,"1","takeall_noedit","open");break;case"Idaho_2020_state_upper":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/idaho/2020_house.svg",16,.2,"1","takeall_noedit","open");break;case"Idaho_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/idaho/2020_house.svg",16,.2,"2","proportional","open");break;case"Iowa_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/iowa/2020_house.svg",16,.2,"1","takeall_noedit","open");break;case"Iowa_2020_state_upper":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/iowa/2020_senate.svg",16,.2,"1","takeall_noedit","open");break;case"Michigan_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/michigan/2020_house.svg",16,.2,"1","takeall_noedit","open");break;case"Minnesota_2020_state_upper":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/minnesota/2020_upper.svg",16,.5,"1","takeall_noedit","open");break;case"Minnesota_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/minnesota/2020_house.svg",16,.5,"1","takeall_noedit","open");break;case"NewJersey_2020_state_upper":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/newjersey/2020_house.svg",16,.1,"1","takeall_noedit","open");break;case"NewJersey_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/newjersey/2020_house.svg",16,.1,"2","proportional","open");break;case"NewMexico_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/newmexico/2020_house.svg",16,.1,"1","takeall_noedit","open");break;case"NewYork_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/newyork/2020_lower.svg",16,.1,"1","takeall_noedit","open");break;case"NorthCarolina_2020_state_upper":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/northcarolina/2020_senate.svg",16,.5,"1","takeall_noedit","open");break;case"NorthDakota_2020_state_upper":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/northdakota/2020_upper.svg",16,.1,"1","takeall_noedit","open");break;case"NorthDakota_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/northdakota/2020_house.svg",16,.1,"2","proportional","open");break;case"Ohio_2020_state_upper":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/ohio/2020_upper.svg",16,.05,"1","takeall_noedit","open");break;case"Ohio_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/ohio/2020_lower.svg",16,.1,"1","takeall_noedit","open");break;case"Oregon_2020_state_upper":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/oregon/2020_upper.svg",16,0,"1","takeall_noedit","open");break;case"Oregon_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/oregon/2020_house.svg",16,.1,"1","takeall_noedit","open");break;case"Pennsylvania_2020_state_upper":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/pennsylvania/2020_upper.svg",16,.5,"1","takeall_noedit","open");break;case"Pennsylvania_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/pennsylvania/2020_house.svg",16,.25,"1","takeall_noedit","open");break;case"SouthDakota_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/southdakota/2020_house.svg",16,1,"1","takeall_noedit","open");break;case"Texas_2020_state_upper":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/texas/2020_upper.svg",16,.75,"1","takeall_noedit","open");break;case"Texas_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/texas/2020_house.svg",16,.5,"1","takeall_noedit","open");break;case"Virginia_2020_state_upper":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/virginia/2020_senate.svg",16,.015,"1","takeall_noedit","open");break;case"Virginia_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/virginia/2020_house.svg",16,.015,"1","takeall_noedit","open");break;case"Washington_2020_state_upper":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/washington/2020_house.svg",16,.15,"1","takeall_noedit","open");break;case"Washington_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/washington/2020_house.svg",16,.15,"2","proportional","open");break;case"Wisconsin_2020_state_lower":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/wisconsin/2020_house.svg",16,.5,"1","takeall_noedit","open");break;case"USA_presidential_territories":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/presidential/usa_presidential_territories.svg",16,.75,"usa_territories_ec","takeall","open");break;case"USA_2024_presidential":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/presidential/usa_presidential.svg",16,.75,"usa_2024_ec","takeall","open");break;case"USA_2020_presidential_blank":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/presidential/usa_presidential.svg",16,.75,"usa_ec","takeall","open");break;case"USA_split_maine":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/presidential/usa_1972_presidential.svg",16,.75,"usa_1972_ec","takeall","open");break;case"USA_2022_senate":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/senate/usa_senate.svg",16,1,"1","senatorial","2022");break;case"USA_2020_senate_blank":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/senate/usa_senate.svg",16,1,"1","senatorial","2020");break;case"USA_2022_governors":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/governors/usa_gubernatorial.svg",16,.75,"1","gubernatorial","2022");break;case"USA_2020_governors_blank":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/governors/usa_gubernatorial.svg",16,.75,"1","gubernatorial","2020");break;case"USA_2020_democratic_primary":PresetLoader.loadPreset("democratic primary"),MapLoader.loadMap("./res/usa/primary/usa_dem_primary.svg",16,.75,"dem_primary","proportional","open");break;case"USA_2020_republican_primary":PresetLoader.loadPreset("republican primary"),MapLoader.loadMap("./res/usa/primary/usa_rep_primary.svg",16,.75,"rep_primary","proportional","open");break;case"USA_county":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/county/usa_county.svg",16,.075,"1","takeall_noedit","open");break;case"USA_2022_house":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/house/06-02-2022-house.svg",16,.05,"1","takeall_noedit","open",{enableEraser:!0});break;case"USA_2020_house":case"USA_2020_house_blank":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/house/12-2-2019-house.svg",16,.075,"1","takeall_noedit","open",{enableEraser:!0});break;case"USA_2008_house":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/house/usa_congressional_2008.svg",16,.005,"1","takeall_noedit","open");break;case"USA_governors":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/governors/usa_gubernatorial.svg",16,.75,"1","gubernatorial","open");break;case"USA_senate":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/senate/usa_senate.svg",16,.75,"1","senatorial","open");break;case"USA_senate_class_1":PresetLoader.loadPreset("classic"),MapLoader.loadPresetMap("usa/USA_senate_class_1");break;case"USA_senate_class_2":PresetLoader.loadPreset("classic"),MapLoader.loadPresetMap("usa/USA_senate_class_2");break;case"USA_senate_class_3":PresetLoader.loadPreset("classic"),MapLoader.loadPresetMap("usa/USA_senate_class_3");break;case"USA_takeall":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/presidential/usa_no_districts.svg",16,.75,"usa_no_districts_ec","takeall","open");break;case"USA_proportional":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa/presidential/usa_no_districts.svg",16,.75,"usa_no_districts_ec","proportional","open");break;case"USA_pre_civilwar":MapLoader.loadMap("./res/usa/presidential/usa_pre_civilwar.svg",16,.75,"usa_pre_civilwar_ec","presidential","open");break;case"Pakistan_national_assembly":PresetLoader.loadPreset("pakistan"),MapLoader.loadMap("./res/pak/pakistan_constituencies.svg",16,.02,"1","takeall_noedit","open");break;case"Argentina_chamber_of_deputies":PresetLoader.loadPreset("argentina"),MapLoader.loadMap("./res/arg/argentina_provinces_buenos.svg",16,.75,"argentina_chamber_of_deputies","proportional","open");break;case"India_2019_lok_sabha":PresetLoader.loadPreset("none"),MapLoader.loadPresetMap("ind/"+id);break;case"USA_Canada":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/other/usa_canada.svg",16,.01,"1","takeall","open");break;case"Germany_states":PresetLoader.loadPreset("germany"),MapLoader.loadMap("./res/deu/germany.svg",16,1,"1","takeall","open");break;case"Germany_bundestag":PresetLoader.loadPreset("germany"),MapLoader.loadMap("./res/deu/germany_constituencies.svg",16,.25,"1","takeall_noedit","open");break;case"France_national_assembly":PresetLoader.loadPreset("france"),MapLoader.loadMap("./res/fra/france_constituencies.svg",16,.25,"1","takeall_noedit","open");break;case"Netherlands_provinces":PresetLoader.loadPreset("netherlands"),MapLoader.loadMap("./res/nld/netherlands_provinces.svg",16,.15,"netherlands_provinces","proportional","open");break;case"Netherlands_gemeenten":PresetLoader.loadPreset("netherlands"),MapLoader.loadMap("./res/nld/netherlands_gemeenten.svg",16,.15,"1","takeall_noedit","open");break;case"Italy_states":PresetLoader.loadPreset("italy"),MapLoader.loadMap("./res/ita/italy.svg",16,1,"1","takeall_noedit","open");break;case"Portugal_assembly_of_the_republic":PresetLoader.loadPreset("portugal"),MapLoader.loadMap("./res/prt/portugal_constituencies.svg",16,.25,"portugal_constituencies","proportional","open");break;case"Poland":PresetLoader.loadPreset("portugal"),MapLoader.loadMap("./res/pol/poland_senate.svg",16,.25,"1","takeall_noedit","open");break;case"Spain_congress_of_deputies":PresetLoader.loadPreset("spain"),MapLoader.loadMap("./res/esp/spain_constituencies.svg",16,.25,"spain_constituencies","proportional","open");break;case"Sweden_riksdag":PresetLoader.loadPreset("sweden"),MapLoader.loadMap("./res/swe/sweden_districts.svg",25,.25,"sweden_riksdag","proportional","open");break;case"Turkey_national_assembly":PresetLoader.loadPreset("turkey"),MapLoader.loadMap("./res/tur/turkey_provinces.svg",16,.5,"turkey_national_assembly","proportional","open");break;case"India_lok_sabha":PresetLoader.loadPreset("india"),MapLoader.loadMap("./res/ind/india_constituencies.svg",16,.1,"1","takeall_noedit","open");break;case"SouthAfrica_national_assembly":PresetLoader.loadPreset("southafrica"),MapLoader.loadMap("./res/zaf/south_africa_provinces.svg",25,.25,"south_africa_national_assembly","proportional","open");break;case"UnitedKingdom_house_of_commons":PresetLoader.loadPreset("uk"),MapLoader.loadMap("./res/ukd/unitedkingdom.svg",16,.075,"1","takeall_noedit","open");break;case"UnitedKingdom_house_of_commons_proposed_2023":PresetLoader.loadPreset("uk"),MapLoader.loadMap("./res/ukd/unitedkingdom_proposed_2023.svg",16,.05,"1","takeall_noedit","open");break;case"UnitedKingdom_historic_counties":PresetLoader.loadPreset("uk"),MapLoader.loadMap("./res/ukd/unitedkingdom_historic_counties.svg",16,.4,"1","takeall","open");break;case"Ukraine":PresetLoader.loadPreset("uk"),MapLoader.loadMap("./res/ukr/ukraine.svg",16,.1,"1","takeall_noedit","open");break;case"Ireland_dail_eireann":PresetLoader.loadPreset("ireland"),MapLoader.loadMap("./res/irl/ireland_constituencies_2020.svg",16,.075,"ireland_constituencies","proportional","open");break;case"Canada_provinces":PresetLoader.loadPreset("canada"),MapLoader.loadMap("./res/can/canada_states.svg",38,2,"1","takeall","open");break;case"Canada_house_of_commons":PresetLoader.loadPreset("canada"),MapLoader.loadMap("./res/can/canada_constituencies.svg",16,.1,"1","takeall_noedit","open");break;case"Australia_house_of_representatives":PresetLoader.loadPreset("australia"),MapLoader.loadMap("./res/aus/australia_constituencies.svg",16,.1,"1","takeall_noedit","open");break;case"Australia_states":PresetLoader.loadPreset("australia"),MapLoader.loadMap("./res/aus/australia.svg",16,.075,"1","takeall","open");break;case"Brazil_chamber_of_deputies":PresetLoader.loadPreset("brazil"),MapLoader.loadMap("./res/bra/brazil_states.svg",16,50,"brazil_deputies","proportional","open");break;case"Brazil_federal_senate":PresetLoader.loadPreset("brazil"),MapLoader.loadMap("./res/bra/brazil_states.svg",16,50,"3","proportional","open");break;case"Russia_federal_council":PresetLoader.loadPreset("russia"),MapLoader.loadMap("./res/rus/russia_federal_subjects.svg",16,.25,"2","proportional","open");break;case"Russia_duma":PresetLoader.loadPreset("russia"),MapLoader.loadMap("./res/rus/russia_constituencies.svg",16,.15,"duma","takeall_noedit","open");break;case"Trinidad_Tobago_house_of_representatives":PresetLoader.loadPreset("trinidad_tobago"),MapLoader.loadMap("./res/tto/trinidad_tobago_house_of_representatives.svg",16,.25,"1","takeall_noedit","open");break;case"Switzerland_national_council":PresetLoader.loadPreset("switzerland"),MapLoader.loadMap("./res/che/switzerland_cantons.svg",16,.25,"switzerland_national_council","proportional","open");break;case"Switzerland_council_of_states":PresetLoader.loadPreset("switzerland"),MapLoader.loadMap("./res/che/switzerland_cantons.svg",16,.25,"switzerland_council_of_states","proportional","open");break;case"EuropeanUnion":PresetLoader.loadPreset("eu"),MapLoader.loadMap("./res/eu/eu.svg",16,.25,"eu_parliament","proportional","open");break;case"World":PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/other/world.svg",38,.25,"1","takeall","open");break;default:PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa_presidential.svg",16,1,"usa_ec","takeall","open")}}static loadMap(filename,fontsize,strokewidth,dataid,type,year,options){var ecEditButton,disableButton,mapHTML,dataname;(MapLoader.save_filename!==filename||MapLoader.save_dataid!==dataid||MapLoader.save_type!==type||MapLoader.save_year!==year||MapLoader.save_fontsize!==fontsize||MapLoader.save_strokewidth!==strokewidth||(options&&options.onLoad&&options.onLoad(),options&&options.clear&&!0===options.clear))&&(setMode("paint"),"open"!==year&&((ecEditButton=document.getElementById("modebutton-ec"))&&(ecEditButton.style.display="none"),(disableButton=document.getElementById("modebutton-delete"))&&(disableButton.style.display="none")),"takeall_noedit"===type&&((ecEditButton=document.getElementById("modebutton-ec"))&&(ecEditButton.style.display="none"),setMode("fill")),"takeall_noedit"!==type&&"takeall"!==type&&"senatorial"!==type&&"gubernatorial"!==type||((disableButton=document.getElementById("modebutton-paint"))&&(disableButton.style.display="none"),setMode("fill")),MapLoader.save_filename=filename,MapLoader.save_dataid=dataid,MapLoader.save_type=type,MapLoader.save_year=year,MapLoader.save_fontsize=fontsize,MapLoader.save_strokewidth=strokewidth,(mapHTML=document.getElementById("map-div")).style.visibility="hidden",totalVotes=0,strokeMultiplier=strokewidth,dataname="./data/"+type+"_"+year,console.log("Map Loader: Loading "+filename),fetch(filename).then(response=>response.text()).then(data=>{let mapdiv=document.getElementById("map-div");mapdiv.innerHTML=data,console.log("Map Loader: Done loading "+filename),MapLoader.onLoadSVG();const svg=document.getElementById("svgdata");function finishOptions(){options&&options.onLoad&&options.onLoad(),showShortcuts();var loadScreen=document.getElementById("application-loading");setTimeout(function(){loadScreen.style.display="none"},200)}data=svg.getBBox(),svg.setAttribute("viewBox","0 0 "+(data.x+data.width+data.x)+" "+(data.y+data.height+data.y)),MapManager.panObject=panzoom(svg,{transformOrigin:{x:.5,y:.5},autocenter:!0,zoomDoubleClickSpeed:1,smoothScroll:!1,initialX:mapdiv.offsetWidth/2,initialY:mapdiv.offsetHeight/2,initialZoom:.85,zoomSpeed:.05,onTouch:function(e){return!1}}),MapManager.centerMap(),onResize(),data=document.getElementById("text");null!==data&&(data.style.fontSize=fontsize+"px"),MapLoader.initData(dataid),countVotes(),ChartManager.updateChart(),LegendManager.updateLegend(),setPalette(CookieManager.cookies.theme);"senatorial"===type&&"open"!==year?MapLoader.loadSenateFile(dataname,finishOptions):"gubernatorial"===type&&"open"!==year?MapLoader.loadGubernatorialFile(dataname,finishOptions):(mapHTML.style.visibility="visible",finishOptions())}))}static onLoadSVG(){ifInIframe()}static loadGubernatorialFile(gubernatorialfile,onLoad){CandidateManager.initCandidates();var candidateNames={};fetch(gubernatorialfile).then(response=>response.text()).then(data=>{console.log("Done loading "+gubernatorialfile);var loadMode="candidate",lines=data.split("\n");""===lines[lines.length-1]&&lines.pop();for(var index=0;index<lines.length;++index){var split,candidate,line=lines[index].trim();"candidate"===loadMode?"!"===line?loadMode="disable":(split=line.split(" "),candidateNames[split[0]]=split[1],candidate=new Candidate(split[1],[split[2],split[3],split[4],split[5]]),CandidateManager.candidates[split[1]]=candidate):"disable"===loadMode&&(split=line.split(" "),line=states.find(state=>state.name===split[0]),candidate=candidateNames[split[1]],"o"===split[1]?line.setColor("Tossup",2):(line.setColor(candidate,0),line.toggleLock()))}countVotes(),ChartManager.updateChart(),LegendManager.updateLegend(),document.getElementById("map-div").style.visibility="visible",onLoad()})}static loadSenateFile(senatefile,onLoad){CandidateManager.initCandidates();var candidateNames={};fetch(senatefile).then(response=>response.text()).then(data=>{console.log("FETCH SEN"),console.log("Done loading "+senatefile);var loadMode="candidate",lines=data.split("\n");""===lines[lines.length-1]&&lines.pop();for(var index=0;index<lines.length;++index){var split,candidate,line=lines[index].trim();"candidate"===loadMode?"!"===line?loadMode="disable":(split=line.split(" "),candidateNames[split[0]]=split[1],candidate=new Candidate(split[1],[split[2],split[3],split[4],split[5]]),CandidateManager.candidates[split[1]]=candidate):"disable"===loadMode&&(split=line.split(" "),candidate=states.find(state=>state.name===split[0]),line=states.find(state=>state.name===split[0]+"-S"),"o"===split[1]?candidate.setColor("Tossup",2):(candidate.setColor(candidateNames[split[1]],0),candidate.toggleLock()),"o"===split[2]?line.setColor("Tossup",2):(line.setColor(candidateNames[split[2]],0),line.toggleLock()))}countVotes(),ChartManager.updateChart(),LegendManager.updateLegend(),document.getElementById("map-div").style.visibility="visible",onLoad()})}static loadSavedMap(data,options){let obj=data;MapLoader.loadMap(obj.filename,obj.fontsize,obj.strokewidth,obj.dataid,obj.type,obj.year,{onLoad:function(){for(var candidateName in obj.candidates){var candidate;"Tossup"!==candidateName&&(obj.candidates[candidateName].constructor===Object?(candidate=obj.candidates[candidateName],CandidateManager.addCandidate(candidateName,candidate.solid,candidate.likely,candidate.lean,candidate.tilt)):(candidate=obj.candidates[candidateName],CandidateManager.addCandidate2(candidateName,candidate)))}for(let stateName in obj.states){var key,stateData=obj.states[stateName];let state=states.filter(state=>state.name===stateName)[0],voteCount=0,maxCandidateName="Tossup",maxCandidateCount=0;for(key in stateData.delegates){var count=stateData.delegates[key];voteCount+=count,count>maxCandidateCount?(maxCandidateName=key,maxCandidateCount=count):count===maxCandidateCount&&(maxCandidateName="Tossup")}state.setVoteCount(voteCount),"Tossup"===maxCandidateName?state.setColor(maxCandidateName,2):state.setColor(maxCandidateName,stateData.colorvalue),stateData.candidate?(state.setColor(stateData.candidate,stateData.colorvalue),"proportional"===obj.type&&(state.delegates=stateData.delegates)):state.delegates=stateData.delegates,state.simulator=stateData.simulator,stateData.disabled&&state.toggleDisable()}for(let stateName in obj.proportional){let stateData=obj.proportional[stateName],state=proportionalStates.filter(state=>state.name===stateName)[0],voteCount=0,maxCandidateName="Tossup",maxCandidateCount=0;for(let key in stateData.delegates){let count=stateData.delegates[key];voteCount+=count,count>maxCandidateCount?(maxCandidateName=key,maxCandidateCount=count):count===maxCandidateCount&&(maxCandidateName="Tossup")}state.setVoteCount(voteCount),"Tossup"===maxCandidateName?state.setColor(maxCandidateName,2):state.setColor(maxCandidateName,stateData.colorvalue),state.simulator=stateData.simulator,state.delegates=stateData.delegates,stateData.disabled&&state.toggleDisable()}countVotes(),ChartManager.updateChart(),LegendManager.updateLegend(),document.getElementById("map-div").style.visibility="visible"}})}static loadFileMap(){var file=document.getElementById("loadfile").files[0],fileReader=new FileReader;fileReader.onload=function(loadEvent){loadEvent=loadEvent.target.result;MapLoader.loadSavedMap(JSON.parse(loadEvent)),closeAllPopups()},fileReader.readAsText(file,"UTF-8")}static initData(dataid){states=[],buttons=[],lands=[];for(var htmlElements=document.getElementById("outlines").children,index=0,length=htmlElements.length;index<length;++index){var htmlElement=htmlElements[index];htmlElement.setAttribute("style","inherit"),htmlElement.setAttribute("cursor","pointer"),null===(name=htmlElement.getAttribute("id"))||name.includes("*lines*")||name.includes("*ignore*")||name.includes("_ignore_")||name.includes("othertext")||"text"===name||(name.includes("-button")?(htmlElement.onclick=function(){buttonClick(this)},htmlElement.addEventListener("mouseover",function(){KeyboardManager.keyStates[70]&&buttonClick(this,{setSolid:!0})}),buttons.push(htmlElement)):name.includes("-land")?(htmlElement.onclick=function(){landClick(this)},htmlElement.addEventListener("mouseover",function(){KeyboardManager.keyStates[70]&&landClick(this,{setSolid:!0})}),lands.push(htmlElement)):(htmlElement.onclick=function(){stateClick(this)},states.push(new State(name,htmlElement,dataid)),states.length,htmlElement.addEventListener("mouseover",function(){KeyboardManager.keyStates[70]&&stateClick(this,{setSolid:!0})})))}var proportional=document.getElementById("proportional");if(proportional)for(var proportionalElements=proportional.children,index=0,length=proportionalElements.length;index<length;++index){var element=proportionalElements[index],name=(element.setAttribute("cursor","pointer"),element.setAttribute("style","inherit"),element.getAttribute("id")),state=new State(name,element,dataid);proportionalStates.push(state),element.onclick=function(){var ref_index=proportionalStates.length-1;return function(){stateClickPaint(proportionalStates[ref_index],{forceProportional:!0})}}()}}static clearMap(){MapLoader.loadMap(MapLoader.save_filename,MapLoader.save_fontsize,MapLoader.save_strokewidth,MapLoader.save_dataid,MapLoader.save_type,MapLoader.save_year,{clear:!0}),MapManager.setLockMap(!1)}static clearMapCandidates(){for(var index=0;index<states.length;++index)(state=states[index]).setColor("Tossup",2),state.resetDelegates();for(var state,index=0;index<proportionalStates.length;++index)(state=proportionalStates[index]).setColor("Tossup",2),state.resetDelegates()}}MapLoader.save_filename="",MapLoader.save_dataid="",MapLoader.save_type="",MapLoader.save_year="",MapLoader.save_fontsize="",MapLoader.save_strokewidth="";class PresetLoader{static loadPreset(value){switch(CandidateManager.initCandidates(),value){case"none":break;case"classic":PresetLoader.loadPresetClassic();break;case"republican primary":PresetLoader.loadPresetRepublicanPrimary();break;case"democratic primary":PresetLoader.loadPresetDemocraticPrimary();break;case"argentina":PresetLoader.loadPresetArgentina();break;case"france":PresetLoader.loadPresetFrance();break;case"germany":PresetLoader.loadPresetGermany();break;case"southafrica":PresetLoader.loadPresetSouthAfrica();break;case"india":PresetLoader.loadPresetIndia();break;case"italy":PresetLoader.loadPresetItaly();break;case"uk":PresetLoader.loadPresetUK();break;case"canada":PresetLoader.loadPresetCanada();break;case"australia":PresetLoader.loadPresetAustralia();break;case"spain":PresetLoader.loadPresetSpain();break;case"turkey":PresetLoader.loadPresetTurkey();break;case"trinidad_tobago":PresetLoader.loadPresetTrinidadTobago();break;case"netherlands":PresetLoader.loadPresetNetherlands();break;case"brazil":PresetLoader.loadPresetBrazil();break;case"ireland":PresetLoader.loadPresetIreland();break;case"russia":PresetLoader.loadPresetRussia();break;case"switzerland":PresetLoader.loadPresetSwitzerland();break;case"sweden":PresetLoader.loadPresetSweden();break;case"portugal":PresetLoader.loadPresetPortugal();break;case"pakistan":PresetLoader.loadPresetPakistan();case"eu":PresetLoader.loadPresetEU()}ChartManager.updateChart(),LegendManager.generateLegend(),LegendManager.updateLegend()}static loadPresetClassic(){var republican=new Candidate("Republican",["#bf1d29","#ff5865","#ff8b98","#cf8980"]),democrat=new Candidate("Democrat",["#1c408c","#577ccc","#8aafff","#949bb3"]);CandidateManager.candidates.Republican=republican,CandidateManager.candidates.Democrat=democrat}static loadPresetRepublicanPrimary(){var trump=new Candidate("Trump",["#bf1d29","#bf1d29","#bf1d29","#bf1d29"]),weld=new Candidate("Weld",["#e6b700","#e6b700","#e6b700","#e6b700"]),walsh=new Candidate("Walsh",["#1c408c","#1c408c","#1c408c","#1c408c"]);CandidateManager.candidates.Trump=trump,CandidateManager.candidates.Weld=weld,CandidateManager.candidates.Walsh=walsh}static loadPresetDemocraticPrimary(){var biden=new Candidate("Biden",["#009900","#009900","#009900","#009900"]),sanders=new Candidate("Sanders",["#457FFF","#457FFF","#457FFF","#457FFF"]),warren=new Candidate("Warren",["#996600","#996600","#996600","#996600"]),gabbard=new Candidate("Gabbard",["#FF0074","#FF0074","#FF0074","#FF0074"]),buttigieg=new Candidate("Buttigieg",["#990099","#990099","#990099","#990099"]),bloomberg=new Candidate("Bloomberg",["#ff9900","#ff9900","#ff9900","#ff9900"]),klobuchar=new Candidate("Klobuchar",["#000000","#000000","#000000","#000000"]);CandidateManager.candidates.Biden=biden,CandidateManager.candidates.Sanders=sanders,CandidateManager.candidates.Warren=warren,CandidateManager.candidates.Bloomberg=bloomberg,CandidateManager.candidates.Buttigieg=buttigieg,CandidateManager.candidates.Klobuchar=klobuchar,CandidateManager.candidates.Gabbard=gabbard}static loadPresetFrance(){var rn=new Candidate("RN",["#004A77","#004A77","#004A77","#004A77"]),lrem=new Candidate("LREM",["#FFD600","#FFD600","#FFD600","#FFD600"]),eelv=new Candidate("ELV",["#7AB41D","#7AB41D","#7AB41D","#7AB41D"]),lr=new Candidate("LR",["#0066CC","#0066CC","#0066CC","#0066CC"]),lfi=new Candidate("LFI",["#C9462C","#C9462C","#C9462C","#C9462C"]),ps=new Candidate("PS",["#ED1651","#ED1651","#ED1651","#ED1651"]);CandidateManager.candidates.RN=rn,CandidateManager.candidates.LREM=lrem,CandidateManager.candidates["ELV"]=eelv,CandidateManager.candidates.LR=lr,CandidateManager.candidates.LFI=lfi,CandidateManager.candidates.PS=ps,LegendManager.toggleLegendLeans()}static loadPresetGermany(){var union=new Candidate("CDU/CSU",["#000000","#000000","#000000","#000000"]),spd=new Candidate("SPD",["#F0001C","#F0001C","#F0001C","#F0001C"]),grn=new Candidate("GRNE",["#46962B","#46962B","#46962B","#46962B"]),afd=new Candidate("AfD",["#009EE0","#009EE0","#009EE0","#009EE0"]),fdp=new Candidate("FDP",["#dec200","#dec200","#dec200","#dec200"]),dl=new Candidate("LINKE",["#BE3075","#BE3075","#BE3075","#BE3075"]);CandidateManager.candidates["CDU/CSU"]=union,CandidateManager.candidates.SPD=spd,CandidateManager.candidates["GRNE"]=grn,CandidateManager.candidates.AfD=afd,CandidateManager.candidates.FDP=fdp,CandidateManager.candidates.LINKE=dl,LegendManager.toggleLegendLeans()}static loadPresetItaly(){var lega=new Candidate("Lega",["#008F21","#008F21","#008F21","#008F21"]),pd=new Candidate("PD",["#FF3643","#FF3643","#FF3643","#FF3643"]),mcs=new Candidate("M5S",["#FFEB3B","#FFEB3B","#FFEB3B","#FFEB3B"]),fi=new Candidate("FI",["#318CE7","#318CE7","#318CE7","#318CE7"]),fdi=new Candidate("FdI",["#003397","#003397","#003397","#003397"]),eu=new Candidate("+Eu",["#FFD700","#FFD700","#FFD700","#FFD700"]);CandidateManager.candidates.Lega=lega,CandidateManager.candidates.PD=pd,CandidateManager.candidates.M5S=mcs,CandidateManager.candidates.FI=fi,CandidateManager.candidates.FdI=fdi,CandidateManager.candidates["+EU"]=eu,LegendManager.toggleLegendLeans()}static loadPresetUK(){var con=new Candidate("CON",["#0087DC","#0087DC","#0087DC","#0087DC"]),lab=new Candidate("LAB",["#DC241f","#DC241f","#DC241f","#DC241f"]),ldm=new Candidate("LDM",["#FDBB30","#FDBB30","#FDBB30","#FDBB30"]),snp=new Candidate("SNP",["#cccc00","#cccc00","#cccc00","#cccc00"]),grn=new Candidate("GRN",["#6AB023","#6AB023","#6AB023","#6AB023"]),dup=new Candidate("DUP",["#D46A4C","#D46A4C","#D46A4C","#D46A4C"]),sf=new Candidate("SF",["#008800","#008800","#008800","#008800"]),pc=new Candidate("PC",["#008142","#008142","#008142","#008142"]),sdlp=new Candidate("SDLP",["#579c85","#579c85","#579c85","#579c85"]),all=new Candidate("ALL",["#EFCD53","#EFCD53","#EFCD53","#EFCD53"]),ind=new Candidate("Ind",["#aaaaaa","#aaaaaa","#aaaaaa","#aaaaaa"]);CandidateManager.candidates.CON=con,CandidateManager.candidates.LAB=lab,CandidateManager.candidates.LDM=ldm,CandidateManager.candidates.SNP=snp,CandidateManager.candidates.GRN=grn,CandidateManager.candidates.DUP=dup,CandidateManager.candidates.SF=sf,CandidateManager.candidates.PC=pc,CandidateManager.candidates.SDLP=sdlp,CandidateManager.candidates.ALL=all,CandidateManager.candidates.Ind=ind,LegendManager.toggleLegendLeans()}static loadPresetCanada(){var con=new Candidate("CON",["#6495ED","#6495ED","#6495ED","#6495ED"]),lib=new Candidate("LIB",["#F08080","#F08080","#F08080","#F08080"]),ndp=new Candidate("NDP",["#F4A460","#F4A460","#F4A460","#F4A460"]),grn=new Candidate("GRN",["#9ACD32","#9ACD32","#9ACD32","#9ACD32"]),bqc=new Candidate("BQC",["#87CEFA","#87CEFA","#87CEFA","#87CEFA"]),ppc=new Candidate("PPC",["#83789E","#83789E","#83789E","#83789E"]);CandidateManager.candidates.CON=con,CandidateManager.candidates.LIB=lib,CandidateManager.candidates.NDP=ndp,CandidateManager.candidates.GRN=grn,CandidateManager.candidates.BQC=bqc,CandidateManager.candidates.PPC=ppc,LegendManager.toggleLegendLeans()}static loadPresetArgentina(){var lc=new Candidate("Let's Change",["#ccae0b","#ccae0b","#ccae0b","#ccae0b"]),fpv=new Candidate("FPV",["#75aadb","#75aadb","#75aadb","#75aadb"]),federal=new Candidate("Federal",["#19bc9d","#19bc9d","#19bc9d","#19bc9d"]),una=new Candidate("UNA",["#0a1172","#0a1172","#0a1172","#0a1172"]),rxa=new Candidate("RxA",["#00677f","#00677f","#00677f","#00677f"]),fcps=new Candidate("FCpS",["#ff0080","#ff0080","#ff0080","#ff0080"]),unity=new Candidate("Unity",["#00774f","#00774f","#00774f","#00774f"]),evolution=new Candidate("Evolution",["#ff0000","#ff0000","#ff0000","#ff0000"]),fit=new Candidate("FIT",["#800000","#800000","#800000","#800000"]),catamarca=new Candidate("Catamarca",["#ff69b4","#ff69b4","#ff69b4","#ff69b4"]),other=new Candidate("Other",["#999999","#999999","#999999","#999999"]);CandidateManager.candidates["Let's Change"]=lc,CandidateManager.candidates.FPV=fpv,CandidateManager.candidates.Federal=federal,CandidateManager.candidates.UNA=una,CandidateManager.candidates.RxA=rxa,CandidateManager.candidates.FCpS=fcps,CandidateManager.candidates.Unity=unity,CandidateManager.candidates.Evolution=evolution,CandidateManager.candidates.FIT=fit,CandidateManager.candidates.Catamarca=catamarca,CandidateManager.candidates.Other=other,LegendManager.toggleLegendLeans()}static loadPresetAustralia(){var lib=new Candidate("LIB",["#0047AB","#0047AB","#0047AB","#0047AB"]),lnp=new Candidate("LNP",["#063C7C","#063C7C","#063C7C","#063C7C"]),nat=new Candidate("NAT",["#006644","#006644","#006644","#006644"]),clp=new Candidate("CLP",["#F8981D","#F8981D","#F8981D","#F8981D"]),ind=new Candidate("IND",["#C0C0C0","#C0C0C0","#C0C0C0","#C0C0C0"]),cen=new Candidate("CEN",["#ff6300","#ff6300","#ff6300","#ff6300"]),grn=new Candidate("GRN",["#39B54A","#39B54A","#39B54A","#39B54A"]),lab=new Candidate("LAB",["#DE3533","#DE3533","#DE3533","#DE3533"]);CandidateManager.candidates.LIB=lib,CandidateManager.candidates.LNP=lnp,CandidateManager.candidates.NAT=nat,CandidateManager.candidates.CLP=clp,CandidateManager.candidates.IND=ind,CandidateManager.candidates.CEN=cen,CandidateManager.candidates.GRN=grn,CandidateManager.candidates.LAB=lab,LegendManager.toggleLegendLeans()}static loadPresetSpain(){var psoe=new Candidate("PSOE",["#EF1C27","#EF1C27","#EF1C27","#EF1C27"]),pp=new Candidate("PP",["#1D84CE","#1D84CE","#1D84CE","#1D84CE"]),vox=new Candidate("Vox",["#63BE21","#63BE21","#63BE21","#63BE21"]),up=new Candidate("Unidas Podemos",["#7B4977","#7B4977","#7B4977","#7B4977"]),cs=new Candidate("Cs",["#EB6109","#EB6109","#EB6109","#EB6109"]),erc=new Candidate("ERC-Sobiranistes",["#FFB232","#FFB232","#FFB232","#FFB232"]),mp=new Candidate("Ms Pas",["#0FDEC4","#0FDEC4","#0FDEC4","#0FDEC4"]),jxcat=new Candidate("JxCat-Junts",["#ED5975","#ED5975","#ED5975","#ED5975"]),eajpnv=new Candidate("EAJ/PNV",["#4AAE4A","#4AAE4A","#4AAE4A","#4AAE4A"]),eh=new Candidate("EH Bildu",["#B5CF18","#B5CF18","#B5CF18","#B5CF18"]),cup=new Candidate("CUP-PR",["#FFED00","#FFED00","#FFED00","#FFED00"]),pacma=new Candidate("PACMA",["#ADBE18","#ADBE18","#ADBE18","#ADBE18"]),cca=new Candidate("CCa-PNC-NC",["#FFD700","#FFD700","#FFD700","#FFD700"]),bng=new Candidate("BNG",["#ADCFEF","#ADCFEF","#ADCFEF","#ADCFEF"]),nas=new Candidate("NA+",["#999999","#999999","#999999","#999999"]),prc=new Candidate("PRC",["#C2CE0C","#C2CE0C","#C2CE0C","#C2CE0C"]),te=new Candidate("Teruel Existe!",["#037252","#037252","#037252","#037252"]);CandidateManager.candidates.PSOE=psoe,CandidateManager.candidates.PP=pp,CandidateManager.candidates.Vox=vox,CandidateManager.candidates["Unidas Podemos"]=up,CandidateManager.candidates.Cs=cs,CandidateManager.candidates["ERC-Sobiranistes"]=erc,CandidateManager.candidates["JxCat-Junts"]=jxcat,CandidateManager.candidates["Ms Pas"]=mp,CandidateManager.candidates["EAJ/PNV"]=eajpnv,CandidateManager.candidates["EH Bildu"]=eh,CandidateManager.candidates["CCa-PNC-NC"]=cca,CandidateManager.candidates.PRC=prc,CandidateManager.candidates["CUP-PR"]=cup,CandidateManager.candidates.PACMA=pacma,CandidateManager.candidates.BNG=bng,CandidateManager.candidates["NA+"]=nas,CandidateManager.candidates["Teruel Existe!"]=te,LegendManager.toggleLegendLeans()}static loadPresetTurkey(){var akp=new Candidate("AKP",["#ffcc00","#ffcc00","#ffcc00","#ffcc00"]),mhp=new Candidate("MHP",["#870000","#870000","#870000","#870000"]),bbp=new Candidate("BBP",["#cc5252","#cc5252","#cc5252","#cc5252"]),chp=new Candidate("CHP",["#e30000","#e30000","#e30000","#e30000"]),hdp=new Candidate("HDP",["#951b88","#951b88","#951b88","#951b88"]),iyi=new Candidate("IYI",["#0099cc","#0099cc","#0099cc","#0099cc"]),sp=new Candidate("SP",["#ff5f5f","#ff5f5f","#ff5f5f","#ff5f5f"]),tip=new Candidate("TIP",["#990000","#990000","#990000","#990000"]),dp=new Candidate("DP",["#ff3333","#ff3333","#ff3333","#ff3333"]),ind=new Candidate("Ind",["#b0b0b0","#b0b0b0","#b0b0b0","#b0b0b0"]);CandidateManager.candidates.AKP=akp,CandidateManager.candidates.MHP=mhp,CandidateManager.candidates.BBP=bbp,CandidateManager.candidates.CHP=chp,CandidateManager.candidates.HDP=hdp,CandidateManager.candidates.IYI=iyi,CandidateManager.candidates.SP=sp,CandidateManager.candidates.TIP=tip,CandidateManager.candidates.DP=dp,CandidateManager.candidates.Ind=ind,LegendManager.toggleLegendLeans()}static loadPresetTrinidadTobago(){var pnm=new Candidate("PNM",["#ff0000","#ff0000","#ff0000","#ff0000"]),unc=new Candidate("UNC",["#e8ac41","#e8ac41","#e8ac41","#e8ac41"]),cop=new Candidate("COP",["#000000","#000000","#000000","#000000"]),pdp=new Candidate("PDP",["#32cd32","#32cd32","#32cd32","#32cd32"]);CandidateManager.candidates.PNM=pnm,CandidateManager.candidates.UNC=unc,CandidateManager.candidates.COP=cop,CandidateManager.candidates.PDP=pdp,LegendManager.toggleLegendLeans()}static loadPresetNetherlands(){var fvd=new Candidate("FvD",["#841818","#841818","#841818","#841818"]),vvd=new Candidate("VVD",["#21276A","#21276A","#21276A","#21276A"]),cda=new Candidate("CDA",["#007C5E","#007C5E","#007C5E","#007C5E"]),gl=new Candidate("GL",["#83BD00","#83BD00","#83BD00","#83BD00"]),pvda=new Candidate("PvdA",["#E12B1A","#E12B1A","#E12B1A","#E12B1A"]),d66=new Candidate("D66",["#00B13D","#00B13D","#00B13D","#00B13D"]),pvv=new Candidate("PVV",["#21468B","#21468B","#21468B","#21468B"]),sp=new Candidate("SP",["#EE161F","#EE161F","#EE161F","#EE161F"]),cu=new Candidate("CU",["#00A7EB","#00A7EB","#00A7EB","#00A7EB"]),pvdd=new Candidate("PvdD",["#006B28","#006B28","#006B28","#006B28"]),a50=new Candidate("50+",["#932390","#932390","#932390","#932390"]),denk=(new Candidate("SGP",["#E95D0F","#E95D0F","#E95D0F","#E95D0F"]),new Candidate("DENK",["#00A7EB","#00A7EB","#00A7EB","#00A7EB"]));CandidateManager.candidates.FvD=fvd,CandidateManager.candidates.VVD=vvd,CandidateManager.candidates.CDA=cda,CandidateManager.candidates.GL=gl,CandidateManager.candidates.PvdA=pvda,CandidateManager.candidates.D66=d66,CandidateManager.candidates.PVV=pvv,CandidateManager.candidates.SP=sp,CandidateManager.candidates.CU=cu,CandidateManager.candidates.PvdD=pvdd,CandidateManager.candidates["50+"]=a50,CandidateManager.candidates.DENK=denk,LegendManager.toggleLegendLeans()}static loadPresetBrazil(){var psl=new Candidate("PSL",["#203B78","#203B78","#203B78","#203B78"]),pp=new Candidate("PP",["#7DC9FF","#7DC9FF","#7DC9FF","#7DC9FF"]),pl=new Candidate("PL",["#0F0073","#0F0073","#0F0073","#0F0073"]),psd=new Candidate("PSD",["#FFA500","#FFA500","#FFA500","#FFA500"]),mdb=new Candidate("MDB",["#30914D","#30914D","#30914D","#30914D"]),prb=new Candidate("PRB",["#00E6A8","#00E6A8","#00E6A8","#00E6A8"]),psdb=new Candidate("PSDB",["#0080FF","#0080FF","#0080FF","#0080FF"]),psl=(new Candidate("DEM",["#8CC63E","#8CC63E","#8CC63E","#8CC63E"]),new Candidate("SD",["#FF9C2B","#FF9C2B","#FF9C2B","#FF9C2B"]),new Candidate("PODE",["#2DA933","#2DA933","#2DA933","#2DA933"]),new Candidate("PTB",["#7B7B7B","#7B7B7B","#7B7B7B","#7B7B7B"]),new Candidate("PSC",["#009118","#009118","#009118","#009118"]),new Candidate("NOVO",["#FF4D00","#FF4D00","#FF4D00","#FF4D00"]),new Candidate("PATRI",["#CCAA00","#CCAA00","#CCAA00","#CCAA00"]),CandidateManager.candidates.PSL=psl,CandidateManager.candidates.PP=pp,CandidateManager.candidates.PL=pl,CandidateManager.candidates.PSD=psd,CandidateManager.candidates.MDB=mdb,CandidateManager.candidates.PRB=prb,CandidateManager.candidates.PSDB=psdb,new Candidate("PT",["#CC0000","#CC0000","#CC0000","#CC0000"])),pp=new Candidate("PSB",["#FFCC00","#FFCC00","#FFCC00","#FFCC00"]),pl=new Candidate("PDT",["#FF0000","#FF0000","#FF0000","#FF0000"]),psd=new Candidate("PSOL",["#700000","#700000","#700000","#700000"]),mdb=(new Candidate("PCdoB",["#A30000","#A30000","#A30000","#A30000"]),new Candidate("CIDADANIA",["#FF9191","#FF9191","#FF9191","#FF9191"]),new Candidate("PMN",["#DD3333","#DD3333","#DD3333","#DD3333"]),new Candidate("REDE",["#00C2BB","#00C2BB","#00C2BB","#00C2BB"]),CandidateManager.candidates.PT=psl,CandidateManager.candidates.PSB=pp,CandidateManager.candidates.PDT=pl,CandidateManager.candidates.PSOL=psd,new Candidate("PROS",["#FF5460","#FF5460","#FF5460","#FF5460"])),prb=new Candidate("AVANTE",["#ED5F36","#ED5F36","#ED5F36","#ED5F36"]);CandidateManager.candidates.PROS=mdb,CandidateManager.candidates.AVANTE=prb,LegendManager.toggleLegendLeans()}static loadPresetIreland(){var finegael=new Candidate("FG",["#6699FF","#6699FF","#6699FF","#6699FF"]),fiannafail=new Candidate("FF",["#66BB66","#66BB66","#66BB66","#66BB66"]),sinnfein=new Candidate("SF",["#326760","#326760","#326760","#326760"]),labour=new Candidate("Lab",["#CC0000","#CC0000","#CC0000","#CC0000"]),spbp=new Candidate("S-PBP",["#E5E500","#E5E500","#E5E500","#E5E500"]),inds4change=new Candidate("I4C",["#FFC0CB","#FFC0CB","#FFC0CB","#FFC0CB"]),socialdemocrats=new Candidate("SD",["#752F8B","#752F8B","#752F8B","#752F8B"]),green=new Candidate("GP",["#99CC33","#99CC33","#99CC33","#99CC33"]),indy=new Candidate("Ind",["#CCCCCC","#CCCCCC","#CCCCCC","#CCCCCC"]);CandidateManager.candidates.FG=finegael,CandidateManager.candidates.FF=fiannafail,CandidateManager.candidates.SF=sinnfein,CandidateManager.candidates.Lab=labour,CandidateManager.candidates["S-PBP"]=spbp,CandidateManager.candidates.I4C=inds4change,CandidateManager.candidates.SD=socialdemocrats,CandidateManager.candidates.GP=green,CandidateManager.candidates.Ind=indy,LegendManager.toggleLegendLeans()}static loadPresetRussia(){var unitedrussia=new Candidate("ER",["#0C2C84","#0C2C84","#0C2C84","#0C2C84"]),libdem=new Candidate("LDPR",["#2862B3","#2862B3","#2862B3","#2862B3"]),communist=new Candidate("CPRF",["#D70000","#D70000","#D70000","#D70000"]),patriots=new Candidate("Patriots",["#F6DF3B","#F6DF3B","#F6DF3B","#F6DF3B"]),just=new Candidate("CP",["#FAB512","#FAB512","#FAB512","#FAB512"]),rodina=new Candidate("Rodina",["#EA484A","#EA484A","#EA484A","#EA484A"]),yabloko=new Candidate("Yabloko",["#00A800","#00A800","#00A800","#00A800"]),indy=new Candidate("Ind",["#CCCCCC","#CCCCCC","#CCCCCC","#CCCCCC"]);CandidateManager.candidates.ER=unitedrussia,CandidateManager.candidates.LDPR=libdem,CandidateManager.candidates.CPRF=communist,CandidateManager.candidates.Patriots=patriots,CandidateManager.candidates.CP=just,CandidateManager.candidates.Rodina=rodina,CandidateManager.candidates.Yabloko=yabloko,CandidateManager.candidates.Ind=indy,LegendManager.toggleLegendLeans()}static loadPresetPortugal(){var ps=new Candidate("PS",["#ff61ea","#ff61ea","#ff61ea","#ff61ea"]),indy=new Candidate("Ind",["#aaaaaa","#aaaaaa","#aaaaaa","#aaaaaa"]),be=new Candidate("BE",["#870909","#870909","#870909","#870909"]),pcp=new Candidate("PCP",["#ff0000","#ff0000","#ff0000","#ff0000"]),pev=new Candidate("PEV",["#008000","#008000","#008000","#008000"]),ppdpsd=new Candidate("PPD/PSD",["#ff9900","#ff9900","#ff9900","#ff9900"]),cdspp=new Candidate("CDS-PP",["#00daff","#00daff","#00daff","#00daff"]),pan=new Candidate("PAN",["#008080","#008080","#008080","#008080"]);CandidateManager.candidates.PS=ps,CandidateManager.candidates.BE=be,CandidateManager.candidates.PCP=pcp,CandidateManager.candidates.PEV=pev,CandidateManager.candidates["PPD/PSD"]=ppdpsd,CandidateManager.candidates["CDS-PP"]=cdspp,CandidateManager.candidates.PAN=pan,CandidateManager.candidates.Ind=indy,LegendManager.toggleLegendLeans()}static loadPresetSouthAfrica(){var anc=new Candidate("ANC",["#006600","#006600","#006600","#006600"]),da=new Candidate("DA",["#005ba6","#005ba6","#005ba6","#005ba6"]),eff=new Candidate("EFF",["#852a2a","#852a2a","#852a2a","#852a2a"]),ifp=new Candidate("IFP",["#ff0000","#ff0000","#ff0000","#ff0000"]),ffp=new Candidate("FF+",["#ec8713","#ec8713","#ec8713","#ec8713"]),acdp=new Candidate("ACDP",["#ba0c2f","#ba0c2f","#ba0c2f","#ba0c2f"]),udm=new Candidate("UDM",["#ffde01","#ffde01","#ffde01","#ffde01"]),atm=new Candidate("ATM",["#00adee","#00adee","#00adee","#00adee"]),good=new Candidate("Good",["#f36900","#f36900","#f36900","#f36900"]),nfp=new Candidate("NFP",["#ff8040","#ff8040","#ff8040","#ff8040"]),aic=new Candidate("AIC",["#ffb543","#ffb543","#ffb543","#ffb543"]),cope=new Candidate("COPE",["#ffca08","#ffca08","#ffca08","#ffca08"]),pac=new Candidate("PAC",["#008718","#008718","#008718","#008718"]),alj=new Candidate("ALJ",["#1c9069","#1c9069","#1c9069","#1c9069"]);CandidateManager.candidates.ANC=anc,CandidateManager.candidates.DA=da,CandidateManager.candidates.EFF=eff,CandidateManager.candidates.IFP=ifp,CandidateManager.candidates["FF+"]=ffp,CandidateManager.candidates.ACDP=acdp,CandidateManager.candidates.UDM=udm,CandidateManager.candidates.ATM=atm,CandidateManager.candidates.Good=good,CandidateManager.candidates.NFP=nfp,CandidateManager.candidates.AIC=aic,CandidateManager.candidates.COPE=cope,CandidateManager.candidates.PAC=pac,CandidateManager.candidates.ALJ=alj,LegendManager.toggleLegendLeans()}static loadPresetIndia(){var bjp=new Candidate("BJP",["#ff9933","#ff9933","#ff9933","#ff9933"]),ysrcp=new Candidate("YSRCP",["#1569c7","#1569c7","#1569c7","#1569c7"]),ss=new Candidate("SS",["#ff6634","#ff6634","#ff6634","#ff6634"]),jd=new Candidate("JD",["#004285","#004285","#004285","#004285"]),bjd=new Candidate("BJD",["#006400","#006400","#006400","#006400"]),bsp=new Candidate("BSP",["#0000ff","#0000ff","#0000ff","#0000ff"]),trs=new Candidate("TRS",["#ff89ce","#ff89ce","#ff89ce","#ff89ce"]),ljp=new Candidate("LJP",["#40ff7e","#40ff7e","#40ff7e","#40ff7e"]),inc=new Candidate("INC",["#00bfff","#00bfff","#00bfff","#00bfff"]),dmk=new Candidate("DMK",["#de1100","#de1100","#de1100","#de1100"]),ncp=new Candidate("NCP",["#008080","#008080","#008080","#008080"]),aitc=new Candidate("AITC",["#00f200","#00f200","#00f200","#00f200"]),sp=new Candidate("SP",["#a30000","#a30000","#a30000","#a30000"]);CandidateManager.candidates.BJP=bjp,CandidateManager.candidates.YSRCP=ysrcp,CandidateManager.candidates.SS=ss,CandidateManager.candidates.JD=jd,CandidateManager.candidates.BJD=bjd,CandidateManager.candidates.BSP=bsp,CandidateManager.candidates.TRS=trs,CandidateManager.candidates.LJP=ljp,CandidateManager.candidates.INC=inc,CandidateManager.candidates.DMK=dmk,CandidateManager.candidates.NCP=ncp,CandidateManager.candidates.AITC=aitc,CandidateManager.candidates.SP=sp,LegendManager.toggleLegendLeans()}static loadPresetSweden(){var sap=new Candidate("SAP",["#ed1231","#ed1231","#ed1231","#ed1231"]),mp=new Candidate("MP",["#2b912b","#2b912b","#2b912b","#2b912b"]),c=new Candidate("C",["#216c3e","#216c3e","#216c3e","#216c3e"]),l=new Candidate("L",["#006ab5","#006ab5","#006ab5","#006ab5"]),v=new Candidate("V",["#ec121e","#ec121e","#ec121e","#ec121e"]),m=new Candidate("M",["#019cdb","#019cdb","#019cdb","#019cdb"]),sd=new Candidate("SD",["#fedf09","#fedf09","#fedf09","#fedf09"]),kd=new Candidate("KD",["#005ea3","#005ea3","#005ea3","#005ea3"]),ind=new Candidate("Ind",["#999999","#999999","#999999","#999999"]);CandidateManager.candidates.SAP=sap,CandidateManager.candidates.MP=mp,CandidateManager.candidates.C=c,CandidateManager.candidates.L=l,CandidateManager.candidates.V=v,CandidateManager.candidates.M=m,CandidateManager.candidates.SD=sd,CandidateManager.candidates.KD=kd,CandidateManager.candidates.Ind=ind,LegendManager.toggleLegendLeans()}static loadPresetSwitzerland(){var svpudc=new Candidate("SVP/UDC",["#088a4b","#088a4b","#088a4b","#088a4b"]),fdpplr=new Candidate("FDP/PLR",["#0e52a0","#0e52a0","#0e52a0","#0e52a0"]),spps=new Candidate("SDP/PSS",["#FA1360","#FA1360","#FA1360","#FA1360"]),gpspes=new Candidate("GPS/PES",["#01df01","#01df01","#01df01","#01df01"]),cvppdc=new Candidate("CVP/PDC",["#ef7d00","#ef7d00","#ef7d00","#ef7d00"]),glppvl=new Candidate("GLP/PVL",["#a6cf42","#a6cf42","#a6cf42","#a6cf42"]),bdppdb=new Candidate("BDP/PBD",["#000000","#000000","#000000","#000000"]),evppev=new Candidate("EVP/PEV",["#ffd735","#ffd735","#ffd735","#ffd735"]),ldt=new Candidate("LdT",["#6495ed","#6495ed","#6495ed","#6495ed"]),pdapst=new Candidate("PdA/PST",["#FF0000","#FF0000","#FF0000","#FF0000"]),sols=new Candidate("SolS",["#ababab","#ababab","#ababab","#ababab"]),eduudf=new Candidate("EDU/UDF",["#9b2a58","#9b2a58","#9b2a58","#9b2a58"]);CandidateManager.candidates["SVP/UDC"]=svpudc,CandidateManager.candidates["FDP/PLR"]=fdpplr,CandidateManager.candidates["SDP/PSS"]=spps,CandidateManager.candidates["GPS/PES"]=gpspes,CandidateManager.candidates["CVP/PDC"]=cvppdc,CandidateManager.candidates["GLP/PVL"]=glppvl,CandidateManager.candidates["BDP/PBD"]=bdppdb,CandidateManager.candidates["EVP/PEV"]=evppev,CandidateManager.candidates["PdA/PST"]=pdapst,CandidateManager.candidates.SolS=sols,CandidateManager.candidates["EDU/UDF"]=eduudf,CandidateManager.candidates.LdT=ldt,LegendManager.toggleLegendLeans()}static loadPresetPakistan(){var pti=new Candidate("PTI",["#ff0f0f","#ff0f0f","#ff0f0f","#ff0f0f"]),mqmp=new Candidate("MQM-P",["#8f0303","#8f0303","#8f0303","#8f0303"]),pmlq=new Candidate("PML-Q",["#00800d","#00800d","#00800d","#00800d"]),bap=new Candidate("BAP",["#9eee58","#9eee58","#9eee58","#9eee58"]),gda=new Candidate("GDA",["#769c1e","#769c1e","#769c1e","#769c1e"]),aml=new Candidate("AML",["#4aee31","#4aee31","#4aee31","#4aee31"]),jwp=new Candidate("JWP",["#d984e3","#d984e3","#d984e3","#d984e3"]),bnpm=new Candidate("BNP-M",["#eee600","#eee600","#eee600","#eee600"]),pmln=new Candidate("PML-N",["#228000","#228000","#228000","#228000"]),ppp=new Candidate("PPP",["#000000","#000000","#000000","#000000"]),mma=new Candidate("MMA",["#004c00","#004c00","#004c00","#004c00"]),anp=new Candidate("ANP",["#ff0800","#ff0800","#ff0800","#ff0800"]),ind=new Candidate("Ind",["#afafaf","#afafaf","#afafaf","#afafaf"]);CandidateManager.candidates.PTI=pti,CandidateManager.candidates["MQM-P"]=mqmp,CandidateManager.candidates["PML-Q"]=pmlq,CandidateManager.candidates.BAP=bap,CandidateManager.candidates.GDA=gda,CandidateManager.candidates.AML=aml,CandidateManager.candidates.JWP=jwp,CandidateManager.candidates["BNP-M"]=bnpm,CandidateManager.candidates["PML-N"]=pmln,CandidateManager.candidates.PPP=ppp,CandidateManager.candidates.MMA=mma,CandidateManager.candidates.ANP=anp,CandidateManager.candidates.Ind=ind,LegendManager.toggleLegendLeans()}static loadPresetEU(){var epp=new Candidate("EPP",["#3399FF","#3399FF","#3399FF","#3399FF"]),pes=new Candidate("PES",["#F0001C","#F0001C","#F0001C","#F0001C"]),alde=new Candidate("ALDE",["#FFD700","#FFD700","#FFD700","#FFD700"]),egp=new Candidate("EGP",["#99CC33","#99CC33","#99CC33","#99CC33"]),ecrp=new Candidate("ECRP",["#0054A5","#0054A5","#0054A5","#0054A5"]),idp=new Candidate("IDP",["#26428B","#26428B","#26428B","#26428B"]),pel=new Candidate("PEL",["#800000","#800000","#800000","#800000"]),efa=new Candidate("EFA",["#662287","#662287","#662287","#662287"]),edp=new Candidate("EDP",["#EE9900","#EE9900","#EE9900","#EE9900"]),ecpm=new Candidate("ECPM",["#0BAE2C","#0BAE2C","#0BAE2C","#0BAE2C"]),ni=new Candidate("NI",["#C0C0C0","#C0C0C0","#C0C0C0","#C0C0C0"]);CandidateManager.candidates.EPP=epp,CandidateManager.candidates.PES=pes,CandidateManager.candidates.ALDE=alde,CandidateManager.candidates.EGP=egp,CandidateManager.candidates.ECRP=ecrp,CandidateManager.candidates.IDP=idp,CandidateManager.candidates.PEL=pel,CandidateManager.candidates.EFA=efa,CandidateManager.candidates.EDP=edp,CandidateManager.candidates.ECPM=ecpm,CandidateManager.candidates.NI=ni,LegendManager.toggleLegendLeans()}}var totalVotes=0,stateCount=0;class State{constructor(name,htmlElement,dataid){this.name=name,this.fakename="District "+ ++stateCount,this.colorValue=2,this.htmlElement=htmlElement,this.candidate="Tossup",this.dataid=dataid,this.voteCount=0,this.voteCount_beforeDisable=0,this.resetVoteCount(),this.disabled=!1,this.locked=!1,this.onChange=function(){}}resetVoteCount(){var count;parseInt(this.dataid)?(count=parseInt(this.dataid),this.setVoteCount(count),this.voteCount_beforeDisable=count):"duma"===this.dataid?"Russia"===this.name?(this.setVoteCount(225),this.voteCount_beforeDisable=225):(this.setVoteCount(1),this.voteCount_beforeDisable=1):"congressional"===this.dataid||"usa_gubernatorial"===this.dataid||"gubernatorial"===this.dataid?(this.setVoteCount(1),this.voteCount_beforeDisable=1):"senate"===this.dataid?(this.setVoteCount(2),this.voteCount_beforeDisable=2):(this.setVoteCount(GlobalData[this.dataid][this.name]),this.voteCount_beforeDisable=GlobalData[this.dataid][this.name])}resetDelegates(){!0!==this.disabled&&(this.delegates={},this.delegates.Tossup=this.voteCount,this.setColor("Tossup",2,{setDelegates:!1}))}setDelegates(candidate,amount){this.delegates[candidate]=amount;var majorityCandidate="Tossup",majorityCount=0,majorityColor=2;for(candidate in this.delegates){var count=this.delegates[candidate];majorityCount<count?"Tossup"!==candidate&&(majorityCandidate=candidate,majorityCount=count,majorityColor=0):count===majorityCount&&(majorityCandidate="Tossup",majorityColor=2)}this.setColor(majorityCandidate,majorityColor,{setDelegates:!1})}setVoteCount(value){var diff=value-this.voteCount;this.voteCount=value,this.delegates={},this.setDelegates("Tossup",value),"proportional"===MapLoader.save_type&&(this.candidate="Tossup",this.setColor("Tossup",2)),totalVotes+=diff;const stateText=document.getElementById(this.name+"-text");null===stateText||"usa_ec"!==MapLoader.save_dataid&&"usa_1972_ec"!==MapLoader.save_dataid&&"usa_no_districts_ec"!==MapLoader.save_dataid&&"usa_pre_civilwar_ec"!==MapLoader.save_dataid&&"usa_territories_ec"!==MapLoader.save_dataid&&"usa_2024_ec"!==MapLoader.save_dataid||(this.name,void 0!==stateText.childNodes[1]?stateText.childNodes[1].innerHTML=" "+value:stateText.childNodes[0].innerHTML=this.name+" "+value)}getHtml(){return this.htmlElement}getDisplayColor(){return this.htmlElement.style.fill}setDisplayColor(color){this.htmlElement.style.fill=color;var button=document.getElementById(this.name+"-button"),button=(null!==button&&(button.style.fill=color),document.getElementById(this.name+"-land"));null!==button&&(button.style.fill=color)}verifyTossupColor(){"Tossup"===this.candidate&&this.setDisplayColor(CandidateManager.TOSSUP.colors[2])}toggleLock(){var stateText,land,button;0==this.locked?(this.disabled=!0,this.locked=!this.locked,this.name.includes("-S")&&(this.htmlElement.style.visibility="hidden"),this.setDisplayColor(CandidateManager.TOSSUP.colors[2]),this.htmlElement.setAttribute("fill-opacity","0.2"),this.htmlElement.setAttribute("stroke-opacity","0.2"),null!==(stateText=document.getElementById(this.name+"-text"))&&stateText.setAttribute("fill-opacity","0.2"),null!==(land=document.getElementById(this.name+"-land"))&&(land.setAttribute("fill-opacity","0.2"),land.setAttribute("stroke-opacity","0.2")),null!==(button=document.getElementById(this.name+"-button"))&&(button.setAttribute("fill-opacity","0.2"),button.setAttribute("stroke-opacity","0.2"))):1==this.locked&&(this.disabled=!1,this.locked=!this.locked,this.setColor(this.candidate,this.colorValue),this.htmlElement.setAttribute("fill-opacity","1.0"),this.htmlElement.setAttribute("stroke-opacity","1.0"),this.name.includes("-S")&&(this.htmlElement.style.visibility="visible"),null!==(stateText=document.getElementById(this.name+"-text"))&&stateText.setAttribute("fill-opacity","1.0"),null!=(land=document.getElementById(this.name+"-land"))&&(land.setAttribute("fill-opacity","1.0"),land.setAttribute("stroke-opacity","1.0")),null!==(button=document.getElementById(this.name+"-button"))&&(button.setAttribute("fill-opacity","1.0"),button.setAttribute("stroke-opacity","1.0")))}toggleDisable(){var stateText,land,button,stateLandText;1!=this.locked&&(0==this.disabled?(this.setVoteCount(0),this.setColor("Tossup",2),this.disabled=!this.disabled,this.htmlElement.setAttribute("fill-opacity","0.25"),this.htmlElement.setAttribute("stroke-opacity","0.25"),this.name.includes("-S"),"senatorial"!==MapLoader.save_type&&null!==(stateText=document.getElementById(this.name+"-text"))&&stateText.setAttribute("fill-opacity","0.25"),null!==(land=document.getElementById(this.name+"-land"))&&(land.setAttribute("fill-opacity","0.25"),land.setAttribute("stroke-opacity","0.25")),null!==(button=document.getElementById(this.name+"-button"))&&(button.setAttribute("fill-opacity","0.25"),button.setAttribute("stroke-opacity","0.25")),"senatorial"!==MapLoader.save_type&&null!==(stateLandText=document.getElementById(this.name.split("-")[0]+"-text"))&&stateLandText.setAttribute("fill-opacity","0.25")):1==this.disabled&&(this.resetVoteCount(),this.setVoteCount(this.voteCount),this.disabled=!this.disabled,this.setColor(this.candidate,this.colorValue),this.htmlElement.setAttribute("fill-opacity","1.0"),this.htmlElement.setAttribute("stroke-opacity","1.0"),this.name.includes("-S")&&(this.htmlElement.style.visibility="visible"),null!==(stateText=document.getElementById(this.name+"-text"))&&stateText.setAttribute("fill-opacity","1.0"),null!=(land=document.getElementById(this.name+"-land"))&&(land.setAttribute("fill-opacity","1.0"),land.setAttribute("stroke-opacity","1.0")),null!==(button=document.getElementById(this.name+"-button"))&&(button.setAttribute("fill-opacity","1.0"),button.setAttribute("stroke-opacity","1.0")),null!==(stateLandText=document.getElementById(this.name.split("-")[0]+"-text"))&&stateLandText.setAttribute("fill-opacity","1.0")))}incrementCandidateColor(candidate,options={setDelegates:!0}){if("Tossup"===this.candidate&&"Tossup"===candidate){const tooltip=document.getElementById("legend-tooltip");tooltip.classList.remove("flash_animation"),tooltip.offsetWidth,tooltip.classList.add("flash_animation")}this.disabled||(this.candidate!==candidate?this.colorValue=0:KeyboardManager.ctrlPressed()?--this.colorValue:this.colorValue+=1,options.setDelegates&&(this.delegates={},this.delegates.Tossup=0,this.delegates[candidate]=this.voteCount),"Tossup"===this.candidate?3<=this.colorValue&&(this.colorValue=0):(this.colorValue>=CandidateManager.candidates[candidate].colors.length?this.colorValue=0:this.colorValue<0&&(this.colorValue=CandidateManager.candidates[candidate].colors.length-1),CandidateManager.candidates[candidate].singleColor&&(this.colorValue=0)),this.candidate=candidate,"Tossup"===this.candidate&&(this.colorValue=CandidateManager.tossupColor),options=CandidateManager.TOSSUP.colors[CandidateManager.tossupColor],this.candidate in CandidateManager.candidates&&void 0!==CandidateManager.candidates[this.candidate].colors&&null!==CandidateManager.candidates[this.candidate].colors&&(options=CandidateManager.candidates[this.candidate].colors[this.colorValue],this.htmlElement.style.fill=options),null!=(candidate=document.getElementById(this.name+"-land"))&&(candidate.style.fill=options),null!=(candidate=document.getElementById(this.name+"-button"))&&(candidate.style.fill=options),this.onChange&&this.onChange())}highlight(){this.disabled||(this.highlight=!this.highlight,this.htmlElement.style.stroke="#ffff00",""===this.htmlElement.style.strokeWidth&&(this.htmlElement.style.strokeWidth="1px"),this.htmlElement.style.strokeWidth=new String(3*parseInt(this.htmlElement.style.strokeWidth.slice(0,-2)))+"px")}setColor(candidate,colorValue,options={setDelegates:!0}){this.disabled||("Tossup"===(this.candidate=candidate)&&0==colorValue&&(colorValue=2),options.setDelegates&&(this.delegates={},this.delegates.Tossup=0,this.delegates[candidate]=this.voteCount),this.colorValue=colorValue,options=null,(options=CandidateManager.candidates[candidate]?CandidateManager.candidates[candidate].colors[colorValue]:options)&&(this.htmlElement.style.fill=options,this.htmlElement.setAttribute("fill","url(#"+this.name+"_pattern)"),null!=(candidate=document.getElementById(this.name+"-land"))&&(candidate.style.fill=options,candidate.setAttribute("fill","url(#"+this.name+"_pattern)")),null!=(colorValue=document.getElementById(this.name+"-button"))&&(colorValue.style.fill=options,colorValue.setAttribute("fill","url(#"+this.name+"_pattern)"))),this.onChange&&this.onChange())}test_setColor(options){var svg=document.getElementById("svgdata").firstChild,defs=svg.querySelector("#defs"),pattern=(null===defs&&((defs=document.createElementNS("http://www.w3.org/2000/svg","defs")).setAttribute("id","defs"),svg.insertBefore(defs,svg.firstChild)),svg.querySelector("#"+this.name+"_pattern"));for(null===pattern&&((pattern=document.createElementNS("http://www.w3.org/2000/svg","pattern")).setAttribute("id",this.name+"_pattern"),pattern.setAttribute("width","30"),pattern.setAttribute("height","30"),pattern.setAttribute("patternUnits","userSpaceOnUse"),pattern.setAttribute("patternTransform","rotate(-35)"),defs.appendChild(pattern));pattern.firstChild;)pattern.removeChild(pattern.lastChild);for(var candidates=Object.keys(this.delegates),candidateCount=candidates.length,realCandidateCount=0,index=0;index<candidateCount;++index){var candidateName=CandidateManager.candidates[candidates[index]].name;this.delegates[candidates[index]]&&"Tossup"!==candidateName&&(realCandidateCount+=1)}for(var xPos=0,index=0;index<candidateCount;++index){var color,colorName=CandidateManager.candidates[candidates[index]].colors[0],candidateName=CandidateManager.candidates[candidates[index]].name,candidateDelegates=this.delegates[candidates[index]];this.delegates[candidates[index]]&&"Tossup"!==candidateName&&((color=document.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("class",candidateName),color.setAttribute("fill",colorName),color.setAttribute("width",(candidateDelegates/this.voteCount*30).toString()),color.setAttribute("height","100%"),color.setAttribute("x",xPos.toString()),xPos+=30/realCandidateCount,color.setAttribute("y","0"),pattern.appendChild(color))}this.htmlElement.removeAttribute("style")}static setEC(){closeAllPopups();for(var stateId=document.getElementById("state-id").value,input=document.getElementById("state-ec").value,index=0,length=states.length;index<length;++index){var state=states[index];if(state.name===stateId){state.setVoteCount(parseInt(input));break}}countVotes(),ChartManager.updateChart(),LegendManager.updateLegend()}}function buttonClick(clickElement){var id;!1!==php_candidate_edit&&(id=clickElement.getAttribute("id").split("-")[0],clickElement=states.find(state=>state.name===id),"paint"===mode||"fill"===mode?stateClickPaint(clickElement):"ec"===mode?stateClickEC(clickElement):"delete"===mode?stateClickDelete(clickElement):"highlight"===mode&&stateClickHighlight(clickElement),countVotes(),ChartManager.updateChart(),LegendManager.updateLegend())}function landClick(clickElement){var setSolid,stateName,AL,districts;!1!==php_candidate_edit&&"move"!==mode&&(setSolid=KeyboardManager.quickFill(),clickElement=clickElement.getAttribute("id").split("-"),stateName=clickElement[0],clickElement[1],districts=[],states.forEach(function(state,index){state.name.includes(stateName)&&(districts.push(state),state.name.includes("AL")&&(AL=state))}),"paint"===mode||"fill"===mode?(Simulator.view(AL),setSolid?AL.setColor(paintIndex,0):AL.incrementCandidateColor(paintIndex),districts.forEach(function(district){district.setColor(AL.candidate,AL.colorValue)})):"delete"===mode&&districts.forEach(function(district){district.toggleDisable()}),countVotes(),ChartManager.updateChart(),LegendManager.updateLegend())}function stateClick(clickElement){if(!1!==php_candidate_edit){var id=clickElement.getAttribute("id"),state=states.find(state=>state.name===id);switch(mode){case"paint":case"fill":Simulator.view(state),!1===Simulator.ignoreClick&&stateClickPaint(state);break;case"ec":stateClickEC(state);break;case"delete":stateClickDelete(state);break;case"highlight":stateClickHighlight(state)}countVotes(),ChartManager.updateChart(),LegendManager.updateLegend()}}var tooltipTimeout=null;function stateClickPaint(state,options={forceProportional:!1}){if(!state.disabled)if(options.forceProportional)displayProportionalEdit(state);else if("proportional"!==MapLoader.save_type)KeyboardManager.quickFill()?state.setColor(paintIndex,0):KeyboardManager.areaSelect()?paintEntireState(state):state.incrementCandidateColor(paintIndex);else{if("proportional"===MapLoader.save_type){if(KeyboardManager.quickFill())return void state.setColor(paintIndex,0);if("fill"===mode)return void state.incrementCandidateColor(paintIndex)}displayProportionalEdit(state)}}function stateClickHighlight(state){state.disabled||state.highlight()}function paintEntireState(state){if("./res/usa/house/12-2-2019-house.svg"===MapLoader.save_filename||"./res/usa/county/usa_county.svg"===MapLoader.save_filename){state.disabled;for(var stateName=state.name.substr(0,2),index=0,length=states.length;index<length;++index){var state_a=states[index],stateName_a="";"./res/usa/house/12-2-2019-house.svg"===MapLoader.save_filename?(stateName=state.name.substr(0,2),stateName_a=state_a.name.substr(0,2)):"./res/usa/county/usa_county.svg"===MapLoader.save_filename&&(stateName=state.name.substr(-2),stateName_a=state_a.name.substr(-2)),stateName_a===stateName&&state_a.setColor(paintIndex,0)}}}function stateClickDelete(state){KeyboardManager.areaSelect()?deleteEntireState(state):state.toggleDisable()}function deleteEntireState(state){if("./res/usa/house/12-2-2019-house.svg"===MapLoader.save_filename||"./res/usa/county/usa_county.svg"===MapLoader.save_filename)for(var setDisable=!state.disabled,stateName=state.name.substr(0,2),index=0,length=states.length;index<length;++index){var state_a=states[index],stateName_a="";"./res/usa/house/12-2-2019-house.svg"===MapLoader.save_filename?(stateName=state.name.substr(0,2),stateName_a=state_a.name.substr(0,2)):"./res/usa/county/usa_county.svg"===MapLoader.save_filename&&(stateName=state.name.substr(-2),stateName_a=state_a.name.substr(-2)),stateName_a!==stateName||(setDisable&&!1===state_a.disabled||!setDisable&&!0===state_a.disabled)&&state_a.toggleDisable()}}function stateClickEC(state){var ecedit,eceditText,input,stateId;!1===state.disabled&&(ecedit=document.getElementById("ecedit"),eceditText=document.getElementById("ecedit-message"),input=document.getElementById("state-ec"),stateId=document.getElementById("state-id"),eceditText.innerHTML="Set "+state.name+" delegates",input.value=state.voteCount,stateId.value=state.name,ecedit.style.display="inline")}function specialClick(clickElement,e){var id=clickElement.getAttribute("id"),clickElement=states.find(state=>state.name===id);"paint"!==mode&&"fill"!==mode||(clickElement.incrementCandidateColor(paintIndex),countVotes(),ChartManager.updateChart(),LegendManager.updateLegend())}function legendClick(candidate,button){paintIndex=candidate,LegendManager.selectCandidateDisplay(button)}function displayProportionalEdit(state){LogoManager.loadButtons(),closeAllPopups();document.getElementById("demdel").style.display="flex";var message=document.getElementById("demdel-message");"SU"!==state.name?message.innerHTML=state.name+"<br><small>"+state.voteCount+" delegates</small>":message.innerHTML="Super<br><small>"+state.voteCount+" delegates</small>";document.getElementById("demdel-state-name").value=state.name;for(var ranges=document.getElementById("demdel-ranges");ranges.firstChild;)ranges.removeChild(ranges.firstChild);var key,range,display,max=state.voteCount,total=0,displayTossup=document.createElement("DIV");for(key in displayTossup.setAttribute("id","display-Tossup"),CandidateManager.candidates)"Tossup"!==key&&((range=document.createElement("INPUT")).setAttribute("id","range-"+key),range.setAttribute("type","range"),range.setAttribute("max",max),void 0===state.delegates[key]&&(state.delegates[key]=0),range.value=state.delegates[key],total+=state.delegates[key],(display=document.createElement("DIV")).setAttribute("id","display-"+key),display.innerHTML=key+" - "+range.value+" - "+(state.delegates[key]/max*100).toFixed(2)+"%",range.oninput=function(){var refstate=state,refkey=key,refdisplay=display,prevvalue=parseInt(range.value);return function(b){var diff;total=(total-=prevvalue)+parseInt(this.value),max<total&&(total-=diff=total-max,this.value-=diff),prevvalue=parseInt(this.value),displayTossup.innerHTML="Tossup - "+(max-total)+" - "+((max-total)/max*100).toFixed(2)+"%",refdisplay.innerHTML=refkey+" - "+this.value+" - "+(this.value/max*100).toFixed(2)+"%",refstate.setDelegates("Tossup",max-total),refstate.setDelegates(refkey,parseInt(this.value)),countVotes(),ChartManager.updateChart(),LegendManager.updateLegend()}}(),ranges.appendChild(display),ranges.appendChild(range));displayTossup.innerHTML="Tossup - "+(max-total)+" - "+((max-total)/max*100).toFixed(2)+"%",ranges.appendChild(displayTossup)}var GlobalData={argentina_chamber_of_deputies:{"Buenos Aires":70,"Buenos Aires City":25,Catamarca:5,Chaco:7,Chubut:5,"Crdoba":18,Corrientes:7,"Entre Ros":9,Formosa:5,Jujuy:6,"La Pampa":5,"La Rioja":5,Mendoza:10,Misiones:7,"Neuqun":5,"Ro Negro":5,Salta:7,"San Juan":6,"San Luis":5,"Santa Cruz":5,"Santa Fe":19,"Santiago del Estero":7,"Tierra del Fuego":5,"Tucumn":9},turkey_national_assembly:{Adana:15,"Adyaman":5,Afyonkarahisar:6,"Ar":4,Aksaray:4,Amasya:3,Ankara:36,Antalya:16,Ardahan:2,Artvin:2,"Aydn":8,"Balkesir":9,"Bartn":2,Batman:5,Bayburt:1,Bilecik:2,"Bingl":3,Bitlis:3,Bolu:3,Burdur:3,Bursa:20,"anakkale":4,"ankr":2,"orum":4,Denizli:8,"Diyarbakr":12,"Dzce":3,Edirne:4,"Elaz":5,Erzincan:2,Erzurum:6,"Eskiehir":7,Gaziantep:14,Giresun:4,"Gmhane":2,"Hakkri":3,Hatay:11,"Idr":2,Isparta:4,"stanbul":98,"zmir":28,"Kahramanmara":8,Kars:3,Kastamonu:3,"Karabk":3,Karaman:3,Kayseri:10,Kilis:2,"Krklareli":3,"Krkkale":3,"Krehir":2,Kocaeli:13,Konya:15,"Ktahya":5,Malatya:6,Manisa:10,Mardin:6,Mersin:13,"Mula":7,"Mu":4,"Nevehir":3,"Nide":3,Ordu:6,Osmaniye:4,Rize:3,Sakarya:7,Samsun:9,Siirt:3,Sinop:2,Sivas:5,"anlurfa":14,"rnak":4,"Tekirda":7,Tokat:5,Trabzon:6,Tunceli:2,"Uak":3,Van:8,Yalova:3,Yozgat:4,Zonguldak:5},south_africa_national_assembly:{"Eastern Cape":25,"Western Cape":23,"Northern Cape":5,Gauteng:48,KwaZulu:41,Limpopo:19,Mpumalanga:15,"Free State":11,"North West Cape":13,"South Africa":200},portugal_constituencies:{Lisbon:47,Porto:39,Braga:19,"Setbal":18,Aveiro:16,Leiria:10,Coimbra:9,Faro:9,"Santarm":9,Viseu:9,Madeira:6,"Viana do Castelo":6,Azores:5,"Vila Real":5,Guarda:4,"Castelo Branco":4,Beja:3,"Bragana":3,"vora":3,Portalegre:2,Europe:2,"Outside Europe":2},ireland_constituencies:{Donegal:5,"Sligo-Leitrim":4,Mayo:4,"Galway West":5,Clare:4,Kerry:5,"Cork South-West":3,"Cork North-West":3,"Limerick County":3,"Limerick City":4,"Cork South-Central":4,"Cork North-Central":4,"Cork East":4,Waterford:4,Tipperary:5,"Carlow-Kilkenny":5,Wexford:5,Wicklow:5,"Kildare North":4,"Kildare South":4,"Laois-Offaly":5,"Galway East":3,"Roscommon-Galway":3,"Longford-Westmeath":4,"Meath West":3,"Meath East":3,Louth:5,"Cavan-Monaghan":5,"Dublin Fingal":5,"Dublin West":4,"Dublin North-West":3,"Dublin Bay North":5,"Dublin Mid-West":4,"Dublin South-Central":4,"Dublin Central":4,"Dublin Bay South":4,"Dublin South-West":5,"Dublin Rathdown":3,"Dn Laoghaire":4},brazil_deputies:{"So Paulo":70,"Minas Gerais":53,"Rio de Janeiro":46,Bahia:39,"Rio Grande do Sul":31,"Paran":30,Pernambuco:25,"Cear":22,"Maranho":18,"Gois":17,"Par":17,"Santa Catarina":16,"Paraba":12,"Esprito Santo":10,"Piau":10,Alagoas:9,Acre:8,Amazonas:8,"Amap":8,"Distrito Federal do Brasil":8,"Mato Grosso do Sul":8,"Mato Grosso":8,"Rio Grande do Norte":8,"Rondnia":8,Roraima:8,Sergipe:8,Tocantins:8},netherlands_provinces:{Groningen:43,Friesland:43,Drenthe:41,Overijssel:47,Flevoland:41,Gelderland:55,Utrecht:49,"Noord-Holland":55,"Zuid-Holland":55,Zeeland:39,"Noord-Brabant":55,Limburg:47},spain_constituencies:{"La Corua":8,Pontevedra:7,Lugo:4,Orense:4,Asturias:7,"Len":4,Zamora:3,Salamanca:4,"Cceres":4,Badajoz:6,Huelva:5,Seville:12,"Cdiz":9,Cordoba:6,"Mlaga":11,Granada:7,Almeria:6,Jaen:5,Murcia:10,Alicante:12,Albacete:4,"Ciudad Real":5,Toledo:6,Cuenca:3,Valencia:15,"Castelln":5,Teruel:3,Guadalajara:3,Madrid:37,Avila:3,Segovia:3,Valladolid:5,Palencia:3,Burgos:4,Soria:2,Zaragoza:7,Tarragona:6,Barcelona:32,Girona:6,Lreida:4,Huesca:3,Navarre:5,"La Rioja":4,"lava":4,Guipuzcoa:6,Biscay:8,Cantabria:5,Ceuta:1,Melilla:1,"Santa Cruz de Tenerife":7,"Las Palmas":8,"Balearic Islands":8},switzerland_national_council:{Aargau:16,"Appenzell Outer Rhodes":1,"Appenzell Inner Rhodes":1,"Basel-Landschaft":7,"Basel-Stadt":5,Bern:24,Fribourg:7,Geneva:12,Glarus:1,"Graubnden":5,Jura:2,Lucerne:9,"Neuchtel":4,Nidwalden:1,Obwalden:1,"St. Gallen":12,Schaffhausen:2,Schwyz:4,Solothurn:6,Thurgau:6,Ticino:8,Uri:1,Vaud:19,Valais:8,Zurich:35,Zug:3},switzerland_council_of_states:{Aargau:2,"Appenzell Outer Rhodes":1,"Appenzell Inner Rhodes":1,"Basel-Landschaft":1,"Basel-Stadt":1,Bern:2,Fribourg:2,Geneva:2,Glarus:2,"Graubnden":2,Jura:2,Lucerne:2,"Neuchtel":2,Nidwalden:1,Obwalden:1,"St. Gallen":2,Schaffhausen:2,Schwyz:2,Solothurn:2,Thurgau:2,Ticino:2,Uri:2,Vaud:2,Valais:2,Zurich:2,Zug:2},sweden_riksdag:{Sweden:39,"Stockholms kommun":29,Stockholm:39,Uppsala:11,"Sdermanland":9,"stergtland":14,"Jnkping":11,Kronoberg:6,Kalmar:8,Gotland:2,Blekinge:5,"Malm kommun":10,"Skne lns vstra":9,"Skne lns sdra":12,"Skne lns norra och stra":10,"Vrmland":9,"rebro":9,"Vstmanland":8,Dalarna:9,"Gvleborg":9,"Vsternorrland":8,"Jmtland":4,"Vsterbotten":9,Norrbotten:8,Halland:10,"Gteborgs kommun":17,"Vstra Gtalands lns norra":8,"Vstra Gtalands lns stra":9,"Vstra Gtalands lns vstra":11,"Vstra Gtalands lns sdra":7},usa_territories_ec:{AL:9,AK:3,AZ:11,AR:6,CA:55,CO:9,CT:7,DE:3,FL:29,GA:16,HI:4,ID:4,IL:20,IN:11,IA:6,KS:6,KY:8,LA:8,ME:4,"ME-AL":2,"ME-D1":1,"ME-D2":1,MD:10,MA:11,MI:16,MN:10,MS:6,MO:10,MT:3,NE:5,"NE-AL":2,"NE-D1":1,"NE-D2":1,"NE-D3":1,NV:6,NH:4,NJ:14,NM:5,NY:29,NC:15,ND:3,OH:18,OK:7,OR:7,PA:20,RI:4,SC:9,SD:3,TN:11,TX:38,UT:6,VT:3,VA:13,WA:12,WV:5,WI:10,WY:3,DC:3,AS:1,GU:1,MP:1,PR:1,VI:1},usa_ec:{AL:9,AK:3,AZ:11,AR:6,CA:55,CO:9,CT:7,DE:3,FL:29,GA:16,HI:4,ID:4,IL:20,IN:11,IA:6,KS:6,KY:8,LA:8,ME:4,"ME-AL":2,"ME-D1":1,"ME-D2":1,MD:10,MA:11,MI:16,MN:10,MS:6,MO:10,MT:3,NE:5,"NE-AL":2,"NE-D1":1,"NE-D2":1,"NE-D3":1,NV:6,NH:4,NJ:14,NM:5,NY:29,NC:15,ND:3,OH:18,OK:7,OR:7,PA:20,RI:4,SC:9,SD:3,TN:11,TX:38,UT:6,VT:3,VA:13,WA:12,WV:5,WI:10,WY:3,DC:3},usa_2024_ec:{AL:9,AK:3,AZ:11,AR:6,CA:54,CO:10,CT:7,DE:3,FL:30,GA:16,HI:4,ID:4,IL:19,IN:11,IA:6,KS:6,KY:8,LA:8,ME:4,"ME-AL":2,"ME-D1":1,"ME-D2":1,MD:10,MA:11,MI:15,MN:10,MS:6,MO:10,MT:4,NE:5,"NE-AL":2,"NE-D1":1,"NE-D2":1,"NE-D3":1,NV:6,NH:4,NJ:14,NM:5,NY:28,NC:16,ND:3,OH:17,OK:7,OR:8,PA:19,RI:4,SC:9,SD:3,TN:11,TX:40,UT:6,VT:3,VA:13,WA:12,WV:4,WI:10,WY:3,DC:3},usa_1972_ec:{AL:9,AK:3,AZ:6,AR:6,CA:45,CO:7,CT:8,DE:3,FL:17,GA:12,HI:4,ID:4,IL:26,IN:13,IA:8,KS:7,KY:9,LA:10,ME:4,"ME-AL":2,"ME-D1":1,"ME-D2":1,MD:10,MA:14,MI:21,MN:10,MS:7,MO:12,MT:4,NE:5,NV:3,NH:4,NJ:17,NM:4,NY:41,NC:13,ND:3,OH:25,OK:8,OR:6,PA:27,RI:4,SC:8,SD:4,TN:10,TX:26,UT:4,VT:3,VA:11,WA:9,WV:6,WI:11,WY:3,DC:3},usa_pre_civilwar_ec:{AL:9,AK:0,AZ:0,AR:4,CA:4,CO:0,CT:6,DE:3,FL:3,GA:10,HI:0,ID:0,IL:11,IN:13,IA:4,KS:0,KY:12,LA:6,ME:8,MD:8,MA:13,MI:6,MN:4,MS:7,MO:9,MT:0,NE:0,NV:0,NH:5,NJ:7,NM:0,NY:35,NC:10,ND:0,OH:23,OK:0,OR:3,PA:27,RI:4,SC:8,SD:0,TN:12,TX:4,UT:0,VT:5,VA:15,WA:0,WI:5,WY:0,DC:0},usa_no_districts_ec:{AL:9,AK:3,AZ:11,AR:6,CA:55,CO:9,CT:7,DE:3,FL:29,GA:16,HI:4,ID:4,IL:20,IN:11,IA:6,KS:6,KY:8,LA:8,ME:4,MD:10,MA:11,MI:16,MN:10,MS:6,MO:10,MT:3,NE:5,NV:6,NH:4,NJ:14,NM:5,NY:29,NC:15,ND:3,OH:18,OK:7,OR:7,PA:20,RI:4,SC:9,SD:3,TN:11,TX:38,UT:6,VT:3,VA:13,WA:12,WV:5,WI:10,WY:3,DC:3},lte_ec:{NE:11,SE:9,MW:8,WE:6,SW:5,OV:7},dem_primary:{AL:52,AK:15,AS:6,AZ:67,AR:31,CA:415,CO:67,CT:60,DE:21,DA:13,DC:20,FL:219,GA:105,GU:7,HI:24,ID:20,IL:155,IN:82,IA:41,KS:39,KY:54,LA:54,ME:24,MD:96,MA:91,MI:125,MN:75,MS:36,MO:68,MT:19,NE:29,NV:36,NH:24,NJ:126,NM:34,NY:274,NC:110,ND:14,NI:6,OH:136,OK:37,OR:61,PA:186,PR:51,RI:26,SC:54,SD:16,SU:771,TN:64,TX:228,UT:29,VT:16,VI:7,VA:99,WA:89,WV:28,WI:84,WY:14},rep_primary:{AL:50,AK:28,AS:9,AZ:57,AR:40,CA:172,CO:37,CT:28,DE:16,DC:19,FL:122,GA:76,GU:9,HI:19,ID:32,IL:67,IN:70,IA:40,KS:39,KY:46,LA:46,ME:22,MD:38,MA:41,MI:73,MN:39,MS:39,MO:54,MT:27,NE:36,NV:25,NH:22,NJ:49,NM:22,NY:95,NC:71,ND:29,NI:9,OH:82,OK:43,OR:28,PA:88,PR:23,RI:19,SC:50,SD:29,TN:58,TX:155,UT:40,VT:17,VI:9,VA:49,WA:44,WV:34,WI:52,WY:29},eu_parliament:{"IE-S":5,"IE-N":4,"IE-D":4,"BE-D":12,"BE-F":8,"BE-G":1,FR:79,ES:59,PT:21,IT:76,MT:6,CY:6,GR:21,BG:17,RO:33,HR:12,HU:21,SL:8,AT:19,SK:14,CZ:21,PO:52,LI:11,LV:8,EE:7,FI:14,SE:21,DK:14,NL:29,LU:6,DE:96},to_short_hand:{Alabama:"AL",Alaska:"AK",Arizona:"AZ",Arkansas:"AR",California:"CA",Colorado:"CO",Connecticut:"CT",Delaware:"DE",Florida:"FL",Georgia:"GA",Hawaii:"HI",Idaho:"ID",Illinois:"IL",Indiana:"IN",Iowa:"IA",Kansas:"KS",Kentucky:"KY",Louisiana:"LA",Maine:"ME",Maryland:"MD",Massachusetts:"MA",Michigan:"MI",Minnesota:"MN",Mississippi:"MS",Missouri:"MO",Montana:"MT",Nebraska:"NE",Nevada:"NV","New Hampshire":"NH","New Jersey":"NJ","New Mexico":"NM","New York":"NY","North Carolina":"NC","North Dakota":"ND",Ohio:"OH",Oklahoma:"OK",Oregon:"OR",Pennsylvania:"PA","Rhode Island":"RI","South Carolina":"SC","South Dakota":"SD",Tennessee:"TN",Texas:"TX",Utah:"UT",Vermont:"VT",Virginia:"VA",Washington:"WA","West Virginia":"WV",Wisconsin:"WI",Wyoming:"WY"}};class SimulatorData{}function enableFullscreen(){var el=document.documentElement;"undefined"!=typeof(rfs=el.requestFullScreen||el.webkitRequestFullScreen||el.mozRequestFullScreen||el.msRequestFullScreen)&&rfs.call(el)}function displayCandidateEditMenu(candidate){LogoManager.loadFlags(),LogoManager.loadButtons(),closeAllPopups(),document.getElementById("candidateedit").style.display="flex",document.getElementById("candidate-name").value=candidate;const colors=document.getElementById("editcandidate-colors");for(;colors.firstChild;)colors.removeChild(colors.firstChild);for(const color of CandidateManager.candidates[candidate].colors){const colorElement=document.createElement("input");colorElement.classList.add("editcandidate-color"),colorElement.type="color",colorElement.value=color,colors.appendChild(colorElement)}var hiddeninput=document.getElementById("candidate-originalName");document.getElementById("candidateedit-message").innerHTML="Edit "+candidate,hiddeninput.value=candidate}function displayUpdateServiceWorker(){document.getElementById("notification-update-serviceworker").style.display="inline"}function displayNotification(title,text){LogoManager.loadFlags(),LogoManager.loadButtons();var notification=document.getElementById("notification"),messageHTML=notification.querySelector("#notification-message"),titleHTML=notification.querySelector("#notification-title");notification.style.display="inline",messageHTML.innerHTML=text,titleHTML.innerHTML=title}function customColorAddColor(){const input=document.createElement("input");input.classList.add("customcolor-color"),input.type="color",document.getElementById("customcolor-colors").appendChild(input)}function customColorAddColor(color){const input=document.createElement("input");input.classList.add("customcolor-color"),input.type="color",input.value=color,document.getElementById("customcolor-colors").appendChild(input)}function customColorRemoveColor(){const element=document.getElementById("customcolor-colors");element.removeChild(element.lastChild)}function customColorRemoveAllColors(){const element=document.getElementById("customcolor-colors");for(;element.firstChild;)element.removeChild(element.lastChild)}function editCandidateAddColor(){const input=document.createElement("input");input.classList.add("editcandidate-color"),input.type="color",document.getElementById("editcandidate-colors").appendChild(input)}function editCandidateRemoveColor(){const element=document.getElementById("editcandidate-colors");element.removeChild(element.lastChild)}function addCandidateAddColor(){const input=document.createElement("input");input.classList.add("addcandidate-color"),input.type="color",document.getElementById("addcandidate-colors").appendChild(input)}function addCandidateRemoveColor(){const element=document.getElementById("addcandidate-colors");element.removeChild(element.lastChild)}function addCandidateRemoveAllColors(){const element=document.getElementById("addcandidate-colors");for(;element.firstChild;)element.removeChild(element.lastChild)}function displayAddCandidateMenu(type){LogoManager.loadFlags(),LogoManager.loadButtons(),closeAllPopups(),CookieManager.loadCustomColors(),addCandidateRemoveAllColors();for(let index=0;index<4;index+=1)addCandidateAddColor();document.getElementById("addcandidatemenu").style.display="flex"}function closeAllPopups(){for(var popups=document.getElementsByClassName("popup"),index=0;index<popups.length;++index){var popup=popups[index];popup.style&&(popup.style.display="none")}document.activeElement.blur()}function displayCustomColorEditor(type){if(LogoManager.loadFlags(),LogoManager.loadButtons(),closeAllPopups(),document.getElementById("custom-color-name").value=type,document.getElementById("customcoloreditor").style.display="flex",customColorRemoveAllColors(),CookieManager.cookies[type+"-0"]){let index=0;for(;CookieManager.cookies[type+"-"+index];)customColorAddColor(CookieManager.cookies[type+"-"+index]),index+=1}else for(let index=0;index<4;index+=1)customColorAddColor()}function setPalette(palette,setCookie){switch(setCookie&&CookieManager.appendCookie("theme",palette),palette){case"dark":darkPalette();break;case"greyscale":greyscalePalette();break;case"terminal":terminalPalette();break;case"contrast":contrastPalette();break;case"metallic":metallicPalette();break;case"halloween":halloweenPalette();break;case"white":toWinPalette();break;case"usaelection":usaElectionPalette();break;default:lightPalette()}for(var index=0,length=states.length;index<length;++index)states[index].verifyTossupColor()}function darkPalette(){setBackgroundColor("#181922"),setOtherText("white"),setDisableColor("#212326"),setTossupColor("#6b6e73"),setMapStyle("#181922",1.5),setTextStyle("white","bold"),setChartBorderStyle(1,"#2b2e33"),setChartBarColor("#2b2e33"),setChartBarShadow(""),setClickButtonColor("#2b2e33"),setClickButtonColor("#2B2E33"),setClickButtonTextColor("#FFFFFF"),setMenuColor("#000000"),setSideBarColor("#2b2e33"),setSideBarTextStyle("#ffffff"),setBorderStyle("#000000",7),ChartManager.chartOptions.plugins.datalabels.borderWidth=2,ChartManager.chartOptions.plugins.datalabels.borderRadius=4,ChartManager.chartBarScales.y.ticks.color="#ffffff",ChartManager.chartBarScales.x.ticks.color="#ffffff",ChartManager.setChart(ChartManager.chartType,ChartManager.chartPosition),previousPalette=darkPalette}function greyscalePalette(){setBackgroundColor("#252525"),setOtherText("white"),setDisableColor("#212326"),setTossupColor("#888888"),setMapStyle("#181922",1.5),setTextStyle("white","bold"),setChartBorderStyle(1,"#1b1b1b"),setChartBarColor("#454545"),setChartBarShadow(""),setClickButtonColor("#454545"),setClickButtonTextColor("#FFFFFF"),setMenuColor("#101010"),setSideBarColor("#454545"),setSideBarTextStyle("#ffffff"),setBorderStyle("#252525",7),ChartManager.chartOptions.plugins.datalabels.borderWidth=2,ChartManager.chartOptions.plugins.datalabels.borderRadius=4,ChartManager.chartBarScales.y.ticks.color="#ffffff",ChartManager.chartBarScales.x.ticks.color="#ffffff",ChartManager.setChart(ChartManager.chartType,ChartManager.chartPosition),previousPalette=darkPalette}function terminalPalette(){setBackgroundColor("#000000"),setOtherText("white"),setDisableColor("#bcc8d9"),setTossupColor("black"),setChartBorderStyle(2,"#ffffff"),setTextStyle("white","bold"),setMapStyle("white",1.5),setChartBarColor("black"),setChartBarShadow(""),setClickButtonColor("#000000"),setClickButtonTextColor("#ffffff"),setMenuColor("#f8f9fa"),setSideBarColor("#f8f9fa"),setSideBarTextStyle("#000000"),setBorderStyle("#ffffff",6),ChartManager.chartOptions.plugins.datalabels.borderWidth=2,ChartManager.chartOptions.plugins.datalabels.borderRadius=4,ChartManager.chartBarScales.y.ticks.color="#ffffff",ChartManager.chartBarScales.x.ticks.color="#ffffff",ChartManager.setChart(ChartManager.chartType,ChartManager.chartPosition),previousPalette=terminalPalette}function lightPalette(){setBackgroundColor("#dcdcdc"),setOtherText("black"),setDisableColor("#212326"),setTossupColor("#696969"),setMapStyle("#dcdcdc",1.5),setChartBarColor("#3b3e43"),setChartBarShadow(""),setTextStyle("white","bold"),setChartBorderStyle(1,"#3b3e43"),setClickButtonColor("#3b3e43"),setClickButtonTextColor("white"),setMenuColor("#000000"),setSideBarColor("#dcdcdc"),setSideBarTextStyle("#000000"),setBorderStyle("#000000",6),ChartManager.chartOptions.plugins.datalabels.borderWidth=2,ChartManager.chartOptions.plugins.datalabels.borderRadius=4,ChartManager.chartBarScales.y.ticks.color="#ffffff",ChartManager.chartBarScales.x.ticks.color="#ffffff",ChartManager.setChart(ChartManager.chartType,ChartManager.chartPosition),previousPalette=lightPalette}function contrastPalette(){setBackgroundColor("#f8f9fa"),setOtherText("black"),setDisableColor("#212326"),setTossupColor("#36454f"),setMapStyle("#f8f9fa",1.5),setTextStyle("white","bold"),setChartBorderStyle(1,"#fafafa"),setChartBarColor("#fafafa"),setChartBarShadow(""),setClickButtonColor("#fafafa"),setClickButtonTextColor("#000000"),setMenuColor("#222222"),setSideBarColor("#f8f9fa"),setSideBarTextStyle("#000000"),setBorderStyle("#f8f9fa",6),ChartManager.chartOptions.plugins.datalabels.borderWidth=2,ChartManager.chartOptions.plugins.datalabels.borderRadius=4,ChartManager.chartBarScales.y.ticks.color="#000000",ChartManager.chartBarScales.x.ticks.color="#000000",ChartManager.setChart(ChartManager.chartType,ChartManager.chartPosition),previousPalette=contrastPalette}function metallicPalette(){setBackgroundImage("linear-gradient(#696969, #33353b)"),setOtherText("white"),setDisableColor("#212326"),setTossupColor("#808080"),setMapStyle("black",1.5),setTextStyle("white","bold"),setChartBorderStyle(1,"#33353b"),setChartBarColor("#33353b"),setChartBarShadow(""),setClickButtonColor("#33353b"),setClickButtonTextColor("#FFFFFF"),setMenuColor("black"),setSideBarColor("#33353b"),setSideBarTextStyle("#ffffff"),setBorderStyle("#000000",6),ChartManager.chartOptions.plugins.datalabels.borderWidth=2,ChartManager.chartOptions.plugins.datalabels.borderRadius=4,ChartManager.chartBarScales.y.ticks.color="#ffffff",ChartManager.chartBarScales.x.ticks.color="#ffffff",ChartManager.setChart(ChartManager.chartType,ChartManager.chartPosition),previousPalette=metallicPalette}function usaElectionPalette(){setBackgroundImage('url("./res/images/usa_flag.jpeg")',"cover"),setOtherText("black"),setDisableColor("#212326"),setTossupColor("#888888"),setMapStyle("#232323",1.8),setChartBarColor("#454545"),setChartBarColor("#000000"),setChartBarShadow(""),setChartBarShadow("0px -5px 5px 2px #060606"),setTextStyle("white","bold"),setChartBorderStyle(1,"#000000"),setClickButtonColor("#555555"),setClickButtonTextColor("#FFFFFF"),setMenuColor("#101010"),setSideBarColor("#aaaaaa"),setSideBarTextStyle("#000000"),setBorderStyle("#454545",6),ChartManager.chartOptions.plugins.datalabels.borderWidth=2,ChartManager.chartOptions.plugins.datalabels.borderRadius=4,ChartManager.chartBarScales.y.ticks.color="#ffffff",ChartManager.chartBarScales.x.ticks.color="#ffffff",ChartManager.setChart(ChartManager.chartType,ChartManager.chartPosition),previousPalette=usaElectionPalette}function halloweenPalette(){setBackgroundImage('url("./res/images/halloween.jpg")'),setOtherText("#ffffff"),setDisableColor("#dddddd"),setTossupColor("#928e85"),setMapStyle("#000000",1.25),setTextStyle("white","bold"),setChartBorderStyle(1,"#000000"),setChartBarColor("#060606"),setChartBarShadow("0px -5px 5px 2px #060606"),setSideBarColor("#9c9b98"),setSideBarTextStyle("#000000"),setClickButtonColor("#060606"),setClickButtonTextColor("#ffffff"),setMenuColor("#928e85"),setBorderStyle("#ffffff",6),ChartManager.chartOptions.plugins.datalabels.borderWidth=0,ChartManager.chartOptions.plugins.datalabels.borderRadius=2,ChartManager.chartBarScales.y.ticks.color="#ffffff",ChartManager.chartBarScales.x.ticks.color="#ffffff",ChartManager.setChart(ChartManager.chartType,ChartManager.chartPosition),previousPalette=halloweenPalette}function toWinPalette(){setBackgroundColor("#f8f9fa"),setOtherText("black"),setDisableColor("#dddddd"),setTossupColor("#9E8767"),setMapStyle("#fffbf2",1),setTextStyle("white","bold"),setChartBorderStyle(1,"#fafafa"),setChartBarColor("#fafafa"),setChartBarShadow(""),setClickButtonColor("#fafafa"),setClickButtonTextColor("#000000"),setMenuColor("#000000"),setSideBarColor("#f8f9fa"),setSideBarTextStyle("#000000"),setBorderStyle("#f8f9fa",6),ChartManager.chartOptions.plugins.datalabels.borderWidth=0,ChartManager.chartOptions.plugins.datalabels.borderRadius=2,ChartManager.chartBarScales.y.ticks.color="#000000",ChartManager.chartBarScales.x.ticks.color="#000000",ChartManager.setChart(ChartManager.chartType,ChartManager.chartPosition),previousPalette=toWinPalette}function setOtherText(color){var text=document.getElementById("othertext");text&&text.setAttribute("fill",color)}function setBackgroundImage(img,size){var body=document.getElementById("application");body.style.backgroundColor="",body.style.backgroundImage=img,body.style.backgroundSize=size||"auto"}function setBackgroundColor(color){var body=document.getElementById("application");body.style.background=color,body.style.backgroundImage=""}function setChartBorderStyle(width,color){ChartManager.chartBorderWidth=width,ChartManager.chartBorderColor=color,document.getElementById("battlechartright").style.border="1px solid "+color,ChartManager.updateChart(),document.getElementById("legend-div").style.borderColor=color}function setMenuColor(color){document.getElementById("menu-div").style.backgroundColor=color;for(var clickButtons=document.getElementsByClassName("click-button"),index=0;index<clickButtons.length;++index)clickButtons[index].style.borderColor=color}function setMenuImage(image){var menu=document.getElementById("menu-div");menu.style.backgroundImage=image,menu.style.backgroundSize="contain"}function setClickButtonTextColor(color){for(var clickButtons=document.getElementsByClassName("click-button"),index=0;index<clickButtons.length;++index)clickButtons[index].style.color=color}function setClickButtonColor(color){for(var clickButtons=document.getElementsByClassName("click-button"),index=0;index<clickButtons.length;++index)clickButtons[index].style.backgroundColor=color}function setDisableColor(color){CandidateManager.TOSSUP.colors[1]=color}function setTossupColor(color){CandidateManager.TOSSUP.colors[2]=color;document.getElementById("Tossup-text").style.backgroundColor=color;var addCandidateButton=document.getElementById("addcandidate-button-text");addCandidateButton&&(addCandidateButton.style.backgroundColor=color)}function setMapStyle(color,strokeWidth){var outlines=document.getElementById("outlines"),outlines=(outlines.style.stroke=color,outlines.style.strokeWidth=strokeWidth*strokeMultiplier,document.getElementById("proportional")),outlines=(outlines&&(outlines.style.stroke=color,outlines.style.strokeWidth=strokeWidth*strokeMultiplier),document.getElementById("special"));null!=outlines&&(outlines.style.stroke=color,outlines.style.strokeWidth=strokeWidth*strokeMultiplier)}function setBorderStyle(color,strokeWidth){var border=document.getElementById("*lines*");null!==border&&(border.style.stroke=color,border.style.strokeWidth=strokeWidth*strokeMultiplier)}function setSideBarColor(color){var sidebar=document.getElementById("sidebar");sidebar&&(sidebar.style.background=color)}function setSideBarTextStyle(color){var sidebar=document.getElementById("sidebar");sidebar&&(sidebar.style.color=color)}function setSideBarSocialOutline(color,width){var sidebar=document.getElementById("sidebar");if(sidebar)for(var elements=sidebar.querySelectorAll(".sidebar-button"),index=0;index<elements.length;++index){var element=elements[index];element.style.borderColor=color,element.style.borderWidth=width}}function setChartBarColor(color){document.getElementById("chart-div").style.background=color}function setChartBarShadow(shadow){document.getElementById("chart-div").style.boxShadow=shadow}function setTextStyle(color,weight){var text=document.getElementById("text");if(null!==text)for(var key in text.style.strokeWidth=0,text.style.fontWeight=weight,text.style.fill=color,text.style.textAlign="center",text.children){key=text.children[key];try{key.setAttribute("text-anchor","middle"),key.setAttribute("alignment-baseline","central")}catch(e){}}var battlechart=document.getElementById("battlechart"),battlechart=(battlechart.style.color=color,battlechart.style.fontWeight=weight,document.getElementById("legend-div"));battlechart.style.color=color,battlechart.style.weight=weight}function setBattleHorizontal(){document.getElementById("application").style.flexDirection="column-reverse";document.getElementById("map-div").style.height="85%";var sidebar=document.getElementById("chart-div"),sidebar=(sidebar.style.flexDirection="row",sidebar.style.width="100%",sidebar.style.height="15%",document.getElementById("battlechart"));sidebar.style.flexDirection="column",sidebar.style.height="75%",sidebar.style.margin="5%";document.getElementById("battlechartmidpoly").setAttribute("transform","translate(20 0) rotate(90)");sidebar=document.getElementById("battlechartmid"),sidebar.style.height="100%",sidebar.style.width="",sidebar=document.getElementById("battlechartright"),sidebar.style.flexDirection="row",sidebar.style.height="80%",sidebar.style.width="100%",sidebar=document.getElementById("battlechartleft"),sidebar.style.height="20px",sidebar.style.width="20px",sidebar=document.getElementById("bar-1"),sidebar.style.borderRight=sidebar.style.borderBottom,sidebar.style.borderBottom="",sidebar.style.flexDirection="row",sidebar.style.minWidth="0",sidebar=document.getElementById("bar-2");sidebar.style.borderLeft=sidebar.style.borderTop,sidebar.style.borderTop="",sidebar.style.flexDirection="row",sidebar.style.minWidth="0"}function unsetBattleHorizontal(){document.getElementById("application").style.flexDirection="row";document.getElementById("map-div").style.height="100%";var sidebar=document.getElementById("chart-div"),sidebar=(sidebar.style.flexDirection="column",sidebar.style.width="28vw",sidebar.style.height="100%",document.getElementById("battlechart"));sidebar.style.flexDirection="row",sidebar.style.height="100%",sidebar.style.margin="5%",mobile?sidebar.style.width="100%":sidebar.style.width="50%";document.getElementById("battlechartmidpoly").setAttribute("transform","translate(0 0) rotate(0)");sidebar=document.getElementById("battlechartmid");sidebar.style.height="",sidebar.style.width="100%";(sidebar=document.getElementById("battlechartright")).style.flexDirection="column",sidebar.style.width="85%",sidebar.style.height="100%";sidebar=document.getElementById("battlechartleft"),battlechartleft.style.height="20px",battlechartleft.style.width="20px",sidebar=document.getElementById("bar-1"),sidebar.style.borderBottom=sidebar.style.borderRight,sidebar.style.borderRight="",sidebar.style.flexDirection="column",sidebar.style.minWidth="0",sidebar=document.getElementById("bar-2");sidebar.style.borderTop=sidebar.style.borderLeft,sidebar.style.borderLeft="",sidebar.style.flexDirection="column",sidebar.style.minWidth="0"}function toggleYAPNews(){var yapnews=document.getElementById("sidebar");null!==yapnews&&("none"===yapnews.style.display?(yapnews.style.display="inline-flex",gtag("event",currentCache,{event_category:"Sidebar",event_label:"Toggle On"})):(yapnews.style.display="none",gtag("event",currentCache,{event_category:"Sidebar",event_label:"Toggle Off"})),MapManager.centerMap())}function ifInIframe(){if(window.location!==window.parent.location){for(var element=document.getElementById("sidebar"),elements=(element&&(element.style.display="none"),(element=document.getElementById("menu-div"))&&(element.style.display="none"),(element=document.getElementById("yapms-watermark"))&&(element.style.display="flex"),document.getElementsByClassName("adslot_mobile")),index=0;index<elements.length;++index)(element=elements[index]).style.display="none";setPalette("light",!1)}}function showShortcuts(){var countyHouse;"./res/usa/county/usa_county.svg"!==MapLoader.save_filename&&"./res/usa/house/12-2-2019-house.svg"!==MapLoader.save_filename||(countyHouse=document.getElementById("county-house-d"))&&(countyHouse.style.display="")}SimulatorData.USA_2020_Cook={AK:{Republican:100,Democrat:0},AL:{Republican:100,Democrat:0},AR:{Republican:100,Democrat:0},AZ:{Republican:50,Democrat:50},CA:{Republican:0,Democrat:100},CO:{Republican:20,Democrat:80},CT:{Republican:0,Democrat:100},DE:{Republican:0,Democrat:100},FL:{Republican:50,Democrat:50},GA:{Republican:70,Democrat:30},HI:{Republican:0,Democrat:100},IA:{Republican:70,Democrat:30},ID:{Republican:100,Democrat:0},IL:{Republican:0,Democrat:100},IN:{Republican:100,Democrat:0},KS:{Republican:100,Democrat:0},KY:{Republican:100,Democrat:0},LA:{Republican:100,Democrat:0},"ME-AL":{Republican:30,Democrat:70},"ME-D1":{Republican:0,Democrat:100},"ME-D2":{Republican:70,Democrat:20},MI:{Republican:50,Democrat:50},MD:{Republican:0,Democrat:100},MA:{Republican:0,Democrat:100},MN:{Republican:30,Democrat:70},MS:{Republican:100,Democrat:0},MO:{Republican:100,Democrat:0},MT:{Republican:100,Democrat:0},"NE-AL":{Republican:100,Democrat:0},"NE-D1":{Republican:100,Democrat:0},"NE-D2":{Republican:70,Democrat:30},"NE-D3":{Republican:100,Democrat:0},NV:{Republican:30,Democrat:70},NH:{Republican:30,Democrat:70},NJ:{Republican:0,Democrat:100},NM:{Republican:0,Democrat:100},NY:{Republican:0,Democrat:100},NC:{Republican:70,Democrat:30},ND:{Republican:100,Democrat:0},OH:{Republican:80,Democrat:20},OK:{Republican:100,Democrat:0},OR:{Republican:0,Democrat:100},PA:{Republican:50,Democrat:50},RI:{Republican:0,Democrat:100},SC:{Republican:100,Democrat:0},SD:{Republican:100,Democrat:0},TN:{Republican:100,Democrat:0},TX:{Republican:80,Democrat:20},UT:{Republican:100,Democrat:0},VT:{Republican:0,Democrat:100},VA:{Republican:20,Democrat:80},WA:{Republican:0,Democrat:100},WI:{Republican:50,Democrat:50},WV:{Republican:100,Democrat:0},WY:{Republican:100,Democrat:0},DC:{Republican:0,Democrat:100}},document.getElementById("yapnews")&&document.getElementById("yapnews").addEventListener("transitionend",function(){MapManager.centerMap()});class Simulator{static init(){if(!mobile){document.getElementById("simulator-noclick").addEventListener("change",function(event){Simulator.ignoreClick=event.target.checked});for(var presets=document.getElementById("sidebar-presets-select-simulator"),select=(presets.addEventListener("change",function(event){switch(this.value){case"cook":Simulator.cookPresidentialPreset();break;case"random":Simulator.randomPreset();break;case"uniform":Simulator.uniformPreset()}}),document.getElementById("sidebar-presets-select-simulator"));select.firstChild;)select.removeChild(select.firstChild);var option=document.createElement("option");option.text="Custom",option.value="custom",option.selected=!0,option.disabled=!0,option.hidden=!0,presets.appendChild(option),(option=document.createElement("option")).text="Uniform",option.value="uniform",presets.appendChild(option),(option=document.createElement("option")).text="Random",option.value="random",presets.appendChild(option),"USA_2020_presidential"===php_load_map_id?((option=document.createElement("option")).text="Cook",option.value="cook",presets.appendChild(option),!1===php_load_map&&Simulator.cookPresidentialPreset()):!1===php_load_map&&Simulator.uniformPreset(),void 0===states[0].simulator&&Simulator.uniformPreset()}}static uniformPreset(){if(!mobile){console.log("Simulator: Uniform preset"),document.getElementById("sidebar-presets-select-simulator").value="uniform";for(var index=0;index<states.length;++index)for(key in(state=states[index]).simulator={},CandidateManager.candidates)"Tossup"!==key&&(state.simulator[key]=0);for(var state,key,index=0;index<proportionalStates.length;++index)for(key in(state=proportionalStates[index]).simulator={},CandidateManager.candidates)"Tossup"!==key&&(state.simulator[key]=0);Simulator.state&&Simulator.view(Simulator.state)}}static randomPreset(){if(!mobile){console.log("Simulator: Random preset"),document.getElementById("sidebar-presets-select-simulator").value="random";for(var index=0;index<states.length;++index)for(key in(state=states[index]).simulator={},CandidateManager.candidates)"Tossup"!==key&&(state.simulator[key]=100*Math.random());for(var state,key,index=0;index<proportionalStates.length;++index)for(key in(state=proportionalStates[index]).simulator={},CandidateManager.candidates)"Tossup"!==key&&(state.simulator[key]=100*Math.random());Simulator.state&&Simulator.view(Simulator.state)}}static cookPresidentialPreset(){if(!mobile){console.log("Simulator: Cook preset"),document.getElementById("sidebar-presets-select-simulator").value="cook",CandidateManager.addCandidate("Republican","#bf1d29","#ff5865","#ff8b98","#cf8980"),CandidateManager.addCandidate("Democrat","#1c408c","#577ccc","#8aafff","#949bb3"),countVotes(),ChartManager.updateChart();for(var index=0;index<states.length;++index){var key,state=states[index];for(key in state.simulator={},CandidateManager.candidates)"Republican"!==key&&"Democrat"!==key||(state.simulator[key]=SimulatorData.USA_2020_Cook[state.name][key])}Simulator.state&&Simulator.view(Simulator.state)}}static toggle(){var e1,e2,e3,e4,e5;mobile||(Simulator.enabled=!Simulator.enabled,e1=document.getElementById("sidebar-state-simulator"),e2=document.getElementById("sidebar-run-simulator"),e3=document.getElementById("sidebar-simulator-head"),e4=document.getElementById("sidebar-settings-simulator"),e5=document.getElementById("sidebar-presets-simulator"),Simulator.enabled?(e1.style.display="block",e2.style.display="block",e4.style.display="block",e5.style.display="block",e3.innerHTML="Disable Simulator",Simulator.init(),gtag("event",currentCache,{event_category:"Simulator",event_label:"Simulator Enabled"})):(e1.style.display="none",e2.style.display="none",e4.style.display="none",e5.style.display="none",e3.innerHTML="Enable Simulator",gtag("event",currentCache,{event_category:"Simulator",event_label:"Simulator Disabled"})))}static view(state){if(!mobile&&Simulator.enabled){Simulator.state=state;for(var key,ranges=document.getElementById("simulator-ranges");ranges.firstChild;)ranges.removeChild(ranges.firstChild);for(key in CandidateManager.candidates)if("Tossup"!==key){var stateKey,total=0;for(stateKey in state.simulator)total+=state.simulator[stateKey];var percent=100,display=(0!==total&&(percent=(state.simulator[key]/total*100).toFixed(2)),document.createElement("DIV")),percent=(display.setAttribute("id","simulator-display-"+key),display.innerHTML=key+" - "+percent+"%",document.createElement("INPUT"));percent.setAttribute("id","simulator-range-"+key),percent.setAttribute("type","range"),percent.setAttribute("max",100),percent.setAttribute("min",0),percent.setAttribute("step",1),percent.value=state.simulator[key],percent.oninput=function(){var refstate=state,refkey=key;return function(){var key,display,percent,value=parseInt(this.value),total=(refstate.simulator[refkey]=value,0);for(key in CandidateManager.candidates)"Tossup"!==key&&(total+=refstate.simulator[key]);for(key in CandidateManager.candidates)"Tossup"!==key&&(display=document.getElementById("simulator-display-"+key),percent=100,0!==total&&(percent=(refstate.simulator[key]/total*100).toFixed(2)),display.innerHTML=key+" - "+percent+"%")}}(),ranges.appendChild(display),ranges.appendChild(percent)}var title=document.getElementById("simulator-state-title");state.name.match(/(Geometry|path([0-9]+)|g([0-9]+))/g)?title.innerHTML=state.fakename:title.innerHTML=state.name.replace(/_/g," ")}}static run(){mobile||0===Simulator.runState&&(Simulator.runState=2,MapLoader.clearMapCandidates(),Simulator.runTimeout=5e3/states.length,Simulator.runLoop(states,0,"proportional"===MapLoader.save_type||"primary"===MapLoader.save_type),Simulator.runLoop(proportionalStates,0,!0))}static runLoop(stateList,count,proportional){0===stateList.length?--Simulator.runState:setTimeout(function(){var candidateKey,state=stateList[count],candidates=[],totalPower=0;for(candidateKey in state.simulator)totalPower+=state.simulator[candidateKey],candidates.push({name:candidateKey,power:state.simulator[candidateKey]});for(var index=0;index<candidates.length;++index){var percentage=1/candidates.length;0!==totalPower&&(percentage=candidates[index].power/totalPower),0!==index&&(percentage+=candidates[index-1].percent),candidates[index].percent=percentage}for(proportional?Simulator.runProportionalState(state,candidates):Simulator.runTakeAllState(state,candidates),count+=1;count<stateList.length&&stateList[count].disabled;)count+=1;count<stateList.length?Simulator.runLoop(stateList,count,proportional):Simulator.runLoopFinish(stateList)},Simulator.runTimeout)}static runTakeAllState(state,candidates){for(var random=Math.random(),index=0;index<candidates.length;++index){var percent=candidates[index].percent,name=candidates[index].name;if(random<=percent){state.setColor(name,0),countVotes(),ChartManager.updateChart(),LegendManager.updateLegend();break}}}static runProportionalState(state,candidates){for(var total=state.voteCount,index=0;index<total;++index)for(var random=Math.random(),candidateIndex=0;candidateIndex<candidates.length;++candidateIndex)if(random<=candidates[candidateIndex].percent){var name=candidates[candidateIndex].name;state.delegates[name]?state.delegates[name]+=1:state.delegates[name]=1,--state.delegates.Tossup;break}for(var majorityIndex=0,candidateIndex=1;candidateIndex<candidates.length;++candidateIndex){var checkName=candidates[candidateIndex].name,majorityName=candidates[majorityIndex].name;state.delegates[checkName]>state.delegates[majorityName]&&(majorityIndex=candidateIndex)}state.setColor(candidates[majorityIndex].name,0,{setDelegates:!1}),countVotes(),LegendManager.updateLegend(),ChartManager.updateChart()}static runLoopFinish(stateList){var me02,me01,ne03;--Simulator.runState,"usa_ec"===MapLoader.save_dataid&&(me01=stateList.find(obj=>"ME-D1"===obj.name),me02=stateList.find(obj=>"ME-D2"===obj.name),me01.candidate===me02.candidate&&stateList.find(obj=>"ME-AL"===obj.name).setColor(me01.candidate,0),me02=stateList.find(obj=>"NE-D1"===obj.name),me01=stateList.find(obj=>"NE-D2"===obj.name),ne03=stateList.find(obj=>"NE-D3"===obj.name),me02.candidate===me01.candidate&&me01.candidate===ne03.candidate&&stateList.find(obj=>"NE-AL"===obj.name).setColor(me02.candidate,0))}}Simulator.enabled=!1,Simulator.runState=0,Simulator.runTimeout=100,Simulator.ignoreClick=!1,Simulator.state=null;class SaveMap{static log(){var candidate,data={};for(key in data.filename=MapLoader.save_filename,data.dataid=MapLoader.save_dataid,data.type=MapLoader.save_type,data.year=MapLoader.save_year,data.fontsize=MapLoader.save_fontsize,data.strokewidth=MapLoader.save_strokewidth,data.candidates={},data.states={},data.proportional={},CandidateManager.candidates)"Tossup"!==key&&(candidate=CandidateManager.candidates[key],data.candidates[candidate.name]={},data.candidates[candidate.name].solid=candidate.colors[0],data.candidates[candidate.name].likely=candidate.colors[1],data.candidates[candidate.name].lean=candidate.colors[2],data.candidates[candidate.name].tilt=candidate.colors[3],data.candidates[candidate.name]=candidate.colors);for(var stateIndex=0;stateIndex<states.length;++stateIndex){for(key in(state=states[stateIndex]).delegates)0===state.delegates[key]&&delete state.delegates[key];data.states[state.name]={},data.states[state.name].delegates=state.delegates,data.states[state.name].colorvalue=state.colorValue,data.states[state.name].disabled=state.disabled}for(var state,key,stateIndex=0;stateIndex<proportionalStates.length;++stateIndex){for(key in(state=proportionalStates[stateIndex]).delegates)0===state.delegates[key]&&delete state.delegates[key];data.proportional[state.name]={},data.proportional[state.name].delegates=state.delegates,data.proportional[state.name].colorvalue=state.colorValue,data.proportional[state.name].disabled=state.disabled}console.log(JSON.stringify(data))}static upload(img,token){console.log("token: "+token);var candidate,formData=new FormData,data=(formData.append("captcha",token),formData.append("img",img),{});for(key in data.filename=MapLoader.save_filename,data.dataid=MapLoader.save_dataid,data.type=MapLoader.save_type,data.year=MapLoader.save_year,data.fontsize=MapLoader.save_fontsize,data.strokewidth=MapLoader.save_strokewidth,data.candidates={},data.states={},data.proportional={},CandidateManager.candidates)"Tossup"!==key&&(candidate=CandidateManager.candidates[key],data.candidates[candidate.name]={},data.candidates[candidate.name]=candidate.colors);for(var stateIndex=0;stateIndex<states.length;++stateIndex){for(key in(state=states[stateIndex]).delegates)0===state.delegates[key]&&delete state.delegates[key];data.states[state.name]={},data.states[state.name].delegates=state.delegates,data.states[state.name].colorvalue=state.colorValue,data.states[state.name].disabled=state.disabled}for(var state,key,stateIndex=0;stateIndex<proportionalStates.length;++stateIndex){for(key in(state=proportionalStates[stateIndex]).delegates)0===state.delegates[key]&&delete state.delegates[key];data.proportional[state.name]={},data.proportional[state.name].delegates=state.delegates,data.proportional[state.name].colorvalue=state.colorValue,data.proportional[state.name].disabled=state.disabled}formData.append("data",JSON.stringify(data)),fetch("./api/maps/upload.php",{method:"POST",body:formData}).then(response=>response.text()).then(data=>{var url=(data=data.split(" "))[0],data=data[1],shareurl=document.getElementById("shareurl"),shareurl=("reCaptcha_Failed(restart_web_browser)"===url?(shareurl.setAttribute("href",url),shareurl.innerHTML="reCaptcha Failed: possible solution is to restart your web-browser"):"reCaptcha_Bot_Detected"===url?(shareurl.setAttribute("href",url),shareurl.innerHTML="reCaptcha Failed: suspicious activity detected"):(shareurl.setAttribute("href",url),shareurl.innerHTML=url),shareurl.style.display="",document.getElementById("sharebuttons")),shareurl=(shareurl&&(shareurl.style.display="flex"),document.getElementById("downloadbutton")),shareurl=(shareurl&&(mobile?shareurl.style.display="none":(shareurl.style.display="",shareurl.setAttribute("href","https://yapms.org/downloadmap.php?f="+data))),document.getElementById("loading-animation")),data=(shareurl&&(shareurl.style.display="none"),document.getElementById("screenshotimg")),shareurl=(data&&(data.style.display=""),document.getElementById("facebook-share")),data=(shareurl&&(shareurl.setAttribute("href","https://www.facebook.com/sharer.php?u="+url),shareurl.setAttribute("target","_blank")),document.getElementById("twitter-share")),shareurl=(data&&(data.setAttribute("href","https://twitter.com/intent/tweet?text="+url),data.setAttribute("target","_blank")),document.getElementById("reddit-share"));shareurl&&(shareurl.setAttribute("href","https://www.reddit.com/submit?title=My%20YAPms%20Map&url="+url),shareurl.setAttribute("target","_blank")),gtag("event",currentCache,{event_category:"Map Save",event_label:"Map save succeeded"})}).catch(error=>{console.log(error);error=document.getElementById("share-button");error&&error.setAttribute("onclick","share()"),gtag("event",currentCache,{event_category:"Map Save",event_label:"Map save failed"})})}}function numberWithCommas(number){return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function displayVersionInfo(){document.getElementById("versioninfo-text").innerHTML=currentCache}function displayShareMenu(){var sharebuttons=document.getElementById("sharebuttons"),sharebuttons=(sharebuttons&&(sharebuttons.style.display="none"),document.getElementById("shareurl")),sharebuttons=(sharebuttons&&(sharebuttons.style.display="none",sharebuttons.innerHTML=""),document.getElementById("screenshotimg")),sharebuttons=(sharebuttons&&(sharebuttons.style.display="none"),document.getElementById("loading-animation"));sharebuttons&&(sharebuttons.style.display="")}function displayMenu(name){switch(LogoManager.loadFlags(),LogoManager.loadButtons(),closeAllPopups(),document.getElementById(name).style.display="flex",name){case"versionmenu":displayVersionInfo();break;case"sharemenu":displayShareMenu()}}function hideMenu(name){closeAllPopups(),document.getElementById(name).style.display="none"}const currentCache="v6.0.0";let states=[],lands=[],buttons=[],proportionalStates=[],paintIndex="Tossup",mode="paint",mapOptions={},strokeMultiplier=1,previousPalette=function(){toWinPalette()};function share(autoCenter){closeAllPopups(),"undefined"==typeof grecaptcha?(console.log("reCaptcha not detected"),CookieManager.askConsent()):(console.log("reCaptcha detected"),displayMenu("sharemenu"),autoCenter?(MapManager.centerMap(),setTimeout(share_afterCenter,200)):share_afterCenter())}function share_afterCenter(){const button=document.getElementById("share-button");button&&(button.disabled=!0,button.style.opacity="0.5",setTimeout(function(){button.disabled=!1,button.style.opacity="1"},3e3));var application=document.getElementById("application");domtoimage.toPng(application,{width:application.offsetWidth,height:application.offsetHeight}).then(function(data){const image=document.getElementById("screenshotimg"),loadingAnimation=(image.src=data,image.style.width="40vw",image.style.height="auto",image.style.display="",document.getElementById("loading-animation"));loadingAnimation.style.display="none",grecaptcha&&grecaptcha.execute("6LeDYbEUAAAAANfuJ4FxWVjoxPgDPsFGsdTLr1Jo",{action:"share"}).then(function(token){SaveMap.upload(data,token)})}).catch(function(error){console.log("dom-to-image: ",error)})}function setMode(set){LogoManager.loadButtons(),mode=set;document.getElementById("modesbutton");for(var button,modeButtons=document.getElementsByClassName("mode-button"),index=0;index<modeButtons.length;++index)(button=modeButtons[index])&&(button.style.opacity="1");"paint"===set?(button=document.getElementById("modebutton-paint")).style.opacity="0.5":"ec"===set?(button=document.getElementById("modebutton-ec")).style.opacity="0.5":"delete"===set?(button=document.getElementById("modebutton-delete")).style.opacity="0.5":"fill"===set?(button=document.getElementById("modebutton-fill")).style.opacity="0.5":"highlight"===set&&((button=document.getElementById("modebutton-highlight")).style.opacity="0.5")}function verifyPaintIndex(){void 0===CandidateManager.candidates[paintIndex]&&(paintIndex="Tossup")}function countVotes(){const mid=document.getElementById("battlechartmid");for(var key in mid&&mid.setAttribute("fill",CandidateManager.TOSSUP.colors[2]),CandidateManager.candidates){const candidate=CandidateManager.candidates[key];candidate.voteCount=0,candidate.probVoteCounts=[0,0,0,0];for(const state of states)void 0===state.delegates&&(state.delegates={}),void 0===state.delegates[key]&&(state.delegates[key]=0),candidate.voteCount+=state.delegates[key],"Tossup"===state.candidate&&"Tossup"!==key?candidate.probVoteCounts[0]+=state.delegates[key]:candidate.probVoteCounts[state.colorValue]?candidate.probVoteCounts[state.colorValue]+=state.delegates[key]:candidate.probVoteCounts[state.colorValue]=state.delegates[key];for(const state of proportionalStates)void 0===state.delegates&&(state.delegates={}),void 0===state.delegates[key]&&(state.delegates[key]=0,"Tossup"===key&&(state.delegates[key]=state.voteCount)),candidate.voteCount+=state.delegates[key],"Tossup"===state.candidate&&"Tossup"!==key?candidate.probVoteCounts[0]+=state.delegates[key]:candidate.probVoteCounts[state.colorValue]+=state.delegates[key];mid&&candidate.voteCount>Math.ceil(totalVotes/2)&&("Tossup"===key?mid.setAttribute("fill",candidate.colors[2]):mid.setAttribute("fill",candidate.colors[0]))}}function onResize(){var sidebarhtml,charthtml;MapManager.centerMap(),"bottom"===ChartManager.chartPosition?(sidebarhtml=document.getElementById("chart-div"),(charthtml=document.getElementById("chart")).style.height="auto",charthtml.style.width=sidebarhtml.offsetHeight-5+"px"):(sidebarhtml=document.getElementById("chart-div"),(charthtml=document.getElementById("chart")).style.height="auto",charthtml.style.width="100%")}function setChangeCandidate(oldCandidate,newCandidate){for(var stateIndex=0,length=states.length;stateIndex<length;++stateIndex){var state=states[stateIndex];state.candidate===oldCandidate&&state.setColor(newCandidate,state.colorValue,{updateDelegates:!1}),state.delegates[newCandidate]=state.delegates[oldCandidate],state.delegates[oldCandidate]=void 0}}function forceUpdate(){"serviceWorker"in navigator&&navigator.serviceWorker.register("../sw.js").then(function(reg){reg.waiting&&(reg.waiting.postMessage("skipwaiting"),gtag("event",currentCache,{event_category:"Manual Update",event_label:"Manual update from "+currentCache,non_interaction:!0}),setTimeout(function(){location.reload()},150))})}function updateArticles(){fetch("./api/news/get_news.php").then(response=>response.json()).then(data=>{const articles=document.getElementById("yapnews-articles");for(const articleData of data){const article=document.createElement("div"),articleTitle=(article.setAttribute("class","yapnews-article"),document.createElement("a")),articleAuthor=(articleTitle.setAttribute("class","yapnews-article-title"),articleTitle.setAttribute("href",articleData.source),articleTitle.setAttribute("target","_blank"),document.createElement("div")),articleSnippet=(articleAuthor.setAttribute("class","yapnews-article-author"),document.createElement("div"));articleSnippet.setAttribute("class","yapnews-article-snippet"),articleTitle.innerHTML=articleData.title,articleAuthor.innerHTML=articleData.author,articleSnippet.innerHTML=articleData.snippet,article.appendChild(articleTitle),article.appendChild(articleAuthor),article.appendChild(articleSnippet),articles.appendChild(article)}})}function updateMobile(){const clickButtons=document.getElementsByClassName("click-button");for(let index=0;index<clickButtons.length;++index)clickButtons[index].style.padding="7px";const modeButtons=document.getElementsByClassName("mode-button");for(let index=0;index<modeButtons.length;++index)modeButtons[index].style.paddingLeft="12px",modeButtons[index].style.paddingRight="12px";const sidebarToggle=document.getElementById("sidebar-toggle"),lockButton=(sidebarToggle&&(sidebarToggle.style.display="none"),document.getElementById("lockbutton"));lockButton&&(lockButton.style.display="none")}function start(){if(Account.verifyState(),CookieManager.loadCookies(),CookieManager.askConsent(),CandidateManager.initCandidates(),ChartManager.initChart(),ChartManager.setChart("horizontalbattle"),(mobile?updateMobile:updateArticles)(),!0===php_load_map){let url=null;url=!0===php_load_user?"./www-data/users/"+php_load_user_id+"/"+php_load_map_id+".txt.gz":"./www-data/maps/"+php_load_map_id+".txt.gz",MapLoader.loadMapFromURL(url),php_auto_reload&&window.setInterval(function(){MapLoader.loadMapFromURL(url)},3e4+Math.floor(3e4*Math.random()))}else!0===php_load_type_map?MapLoader.loadMapFromId(php_load_map_id):(PresetLoader.loadPreset("classic"),MapLoader.loadMap("./res/usa_presidential.svg",16,1,"usa_ec","presidential","open"));setTimeout(function(){LogoManager.loadButtons()},2500)}window.onerror=function(message,source,lineno,colno,error){message.includes("a[b].target.className.indexOf")||message.includes("Script error.")||gtag("event",currentCache,{event_category:"Error",event_label:message+", "+source+", "+lineno+", "+currentCache,non_interaction:!0})},start(),"serviceWorker"in navigator?(console.log("Attempting to register service worker"),navigator.serviceWorker.register("../sw.js").then(function(a){console.log("SW: registered"),a.waiting&&(console.log("SW: update found"),(a=document.getElementById("update-button"))&&(a.style.display="inline"))},function(err){console.log("SW: register error ",err)})):console.log("No service worker detected");
